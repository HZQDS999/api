<!DOCTYPE html>
<div id="noticeBar" style="background: #1677ff; color: #ffffff; padding: 10px 30px; text-align: center; font-size: 14px; position: fixed; top: 0; left: 0; width: 100%; z-index: 9999; box-sizing: border-box;">
  ğŸ“¢æ¬¢è¿è¿›å…¥å°é»‘å¾®è½¯ç»¼åˆæœåŠ¡ç«™-å®¢æœï¼šQQ113575320 å…¨æ–°æºå¤´ä¸€æ‰‹ å–å®Œåˆ æ¡£æ‹’ç»äºŒæ‰‹ é‡å¤§ä»·ä¼˜ æ‹›åˆä½œä¼™ä¼´ä»£ç† å¾®è½¯é•¿æ•ˆé‚®ç®±æ‰¹å‘ ä»¤ç‰Œå· ç½‘é¡µå· apiå¿«é€Ÿå–ä»¶å· å…¨çƒç‰¹æ®Šåç¼€é‚®ç®±å·--æ‰¿æ¥å¾®è½¯è§£é” ç»‘å®š é£é™© æ”¹å¯† æˆæƒ é‚®ç®±çŠ¶æ€åˆ†ç±»æŸ¥è¯¢ä¸€åˆ‡å¾®è½¯ä¸šåŠ¡ æœ¬ç«™å‘ç°éæ³•ç”¨é€”å…¨åŠ›é…åˆæœ‰å…³éƒ¨é—¨æ‰“å‡» ï¼
  <span onclick="document.getElementById('noticeBar').style.display='none'" style="position: absolute; right: 30px; top: 50%; transform: translateY(-50%); cursor: pointer; font-weight: bold; font-size: 16px; color: #ffffff;">Ã—</span>
</div>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å¾®è½¯é•¿æ•ˆé‚®ç®±å¾®è½¯é‚®ç®±å¿«æ·å–ä»¶ä»¤ç‰Œæ‰¹é‡ç®¡ç†ç³»ç»Ÿå¾®è½¯ä»¤ç‰Œå·oauth2imapopå¾®è½¯é‚®ç®±è´­ä¹°å¡ç½‘é‚®ç®±outlookhotmailå¾®è½¯é‚®ç®±è§£é”æ— æ³•ç™»å½•å¾®è½¯é‚®ç®±è‡ªåŠ¨å‘è´§æŠ€æœ¯æ”¯æŒ-å°é»‘QQ:113575320</title>
<style>
body{font-family:Arial,sans-serif;margin:0;padding:0;display:flex;background-color:#121212;overflow-x:hidden;}
.sidebar{width:250px;background-color:#1e1e1e;color:#e0e0e0;height:100vh;padding:20px;box-sizing:border-box;box-shadow:2px 0 10px rgba(0,0,0,0.5);transition:transform 0.3s ease;position:fixed;z-index:100;}
.sidebar h2{text-align:center;margin-bottom:30px;font-size:24px;color:#3498db;}
.sidebar ul{list-style-type:none;padding:0;}
.sidebar ul li{margin:10px 0;}
.sidebar ul li a{color:#e0e0e0;text-decoration:none;display:flex;align-items:center;padding:10px 15px;border-radius:8px;transition:all 0.3s ease;}
.sidebar ul li a:hover{background-color:#3498db;color:#ffffff;transform:translateX(5px);}
.sidebar ul li a.active{background-color:#3498db;color:#ffffff;font-weight:bold;}
.sidebar ul li a i{margin-right:10px;font-size:18px;}
.sidebar ul li .buy-link{background-color:#3498db;color:#ffffff;font-weight:bold;}
.sidebar ul li .buy-link:hover{background-color:#2980b9;transform:translateX(5px);}
.content{flex-grow:1;padding:30px;background-color:#121212;margin-left:250px;transition:margin-left 0.3s ease;min-height:100vh;box-sizing:border-box;}
.menu-toggle{display:none;position:fixed;top:15px;left:15px;z-index:101;background-color:#3498db;color:white;border:none;width:40px;height:40px;border-radius:50%;font-size:20px;cursor:pointer;box-shadow:0 2px 5px rgba(0,0,0,0.3);}
.mail-search-section{margin:20px 0;display:flex;align-items:center;flex-wrap:wrap;gap:10px;}
.mail-search-section input[type="text"]{padding:8px;border:1px solid #444;border-radius:4px;width:300px;margin-right:10px;background-color:#2d2d2d;color:#e0e0e0;}
.mail-search-section button{padding:8px 16px;background-color:#3498db;color:#ffffff;border:none;border-radius:4px;cursor:pointer;transition:background-color 0.3s ease;}
.mail-search-section button:hover{background-color:#2980b9;}
.mail-search-section button:nth-child(3){background-color:#4a4a4a;margin-left:10px;}
.mail-search-section button:nth-child(3):hover{background-color:#5f5f5f;}
.content-section{display:none;animation:fadeIn 0.5s ease;}
.content-section.active{display:block;}
.dashboard-cards{display:flex;gap:20px;margin-bottom:30px;flex-wrap:wrap;}
.dashboard-card{background-color:#1e1e1e;padding:20px;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,0.5);flex:1;min-width:200px;text-align:center;border:1px solid #333;}
.dashboard-card h3{margin:0;font-size:18px;color:#e0e0e0;}
.dashboard-card p{margin:10px 0 0;font-size:24px;color:#3498db;font-weight:bold;}
.quick-actions{margin-top:30px;display:flex;gap:10px;flex-wrap:wrap;}
.quick-actions a{flex:1;min-width:140px;padding:12px;background:#3498db;color:white;text-align:center;border-radius:8px;text-decoration:none;transition:background-color 0.3s ease;display:flex;align-items:center;justify-content:center;gap:8px;}
.quick-actions a:hover{background-color:#2980b9;}
.upload-section{background-color:#1e1e1e;padding:20px;border-radius:8px;box-shadow:0 2px 4px rgba(0,0,0,0.5);margin-bottom:20px;border:1px solid #333;}
.upload-section .upload-box{border:2px dashed #3498db;border-radius:8px;padding:20px;text-align:center;cursor:pointer;transition:background-color 0.3s ease;}
.upload-section .upload-box.dragover{background-color:#2d3436;border-color:#2980b9;}
.upload-section .upload-box i{font-size:24px;color:#3498db;margin-bottom:10px;}
.upload-section .upload-box p{margin:0;color:#999999;}
.upload-section .upload-box .file-info{margin-top:10px;font-size:14px;color:#3498db;}
.upload-section .upload-box input[type="file"]{display:none;}
.upload-section .delimiter-input{margin-top:20px;display:flex;align-items:center;justify-content:center;flex-wrap:wrap;gap:10px;}
.upload-section .delimiter-input input[type="text"],.upload-section .delimiter-input input[type="password"]{padding:8px;border:1px solid #444;border-radius:4px;width:200px;background-color:#2d2d2d;color:#e0e0e0;}
.upload-section .delimiter-input button{padding:8px 16px;background-color:#3498db;color:#ffffff;border:none;border-radius:4px;cursor:pointer;transition:background-color 0.3s ease;}
.upload-section .delimiter-input button:hover{background-color:#2980b9;}
.group-management{display:flex;align-items:center;flex-wrap:wrap;gap:10px;margin:20px 0;padding:15px;background-color:#2d2d2d;border-radius:8px;border:1px solid #333;}
.group-management label{color:#e0e0e0;font-weight:bold;}
.group-management select{padding:8px;border:1px solid #444;border-radius:4px;background-color:#2d2d2d;color:#e0e0e0;min-width:180px;}
.group-management input[type="text"]{padding:8px;border:1px solid #444;border-radius:4px;width:180px;background-color:#2d2d2d;color:#e0e0e0;}
.group-management button{padding:8px 16px;background-color:#3498db;color:#ffffff;border:none;border-radius:4px;cursor:pointer;transition:background-color 0.3s ease;}
.group-management button.delete-group{background-color:#e74c3c;}
.group-management button.batch-group{background-color:#27ae60;}
.group-management button:hover{opacity:0.9;}
.search-section{margin:20px 0;display:flex;align-items:center;flex-wrap:wrap;gap:10px;}
.search-section input[type="text"]{padding:8px;border:1px solid #444;border-radius:4px;width:300px;background-color:#2d2d2d;color:#e0e0e0;}
.search-section button{padding:8px 16px;background-color:#3498db;color:#ffffff;border:none;border-radius:4px;cursor:pointer;transition:background-color 0.3s ease;}
.search-section button:hover{background-color:#2980b9;}
.search-section button:nth-child(3){background-color:#4a4a4a;}
.search-section button:nth-child(3):hover{background-color:#5f5f5f;}
.table-container{overflow-x:auto;margin-top:20px;}
.email-table,.mail-table{width:100%;min-width:900px;border-collapse:collapse;background-color:#1e1e1e;border-radius:8px;overflow:hidden;box-shadow:0 2px 4px rgba(0,0,0,0.5);border:1px solid #333;}
.email-table th,.email-table td,.mail-table th,.mail-table td{padding:12px 15px;text-align:left;border-bottom:1px solid #333;font-size:14px;color:#e0e0e0;}
.email-table th,.mail-table th{background-color:#2d2d2d;color:#ffffff;font-weight:bold;}
.email-table tr:hover,.mail-table tr:hover{background-color:#2d3436;}
.email-table td,.mail-table td{word-wrap:break-word;}
.email-table .refresh-token{max-width:150px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.email-table .remark-cell{max-width:120px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.email-table .actions,.mail-table .actions{white-space:nowrap;display:flex;gap:5px;}
.email-table .actions button,.mail-table .actions button{padding:6px 12px;border:none;border-radius:4px;cursor:pointer;font-size:12px;transition:background-color 0.3s ease;}
.email-table .actions button.view,.mail-table .actions button.view{background-color:#3498db;color:#ffffff;}
.email-table .actions button.edit{background-color:#27ae60;color:#ffffff;}
.email-table .actions button.edit:hover{background-color:#219653;}
.email-table .actions button.delete,.mail-table .actions button.delete{background-color:#e74c3c;color:#ffffff;}
.email-table .actions button:hover,.mail-table .actions button:hover{opacity:0.9;}
.password-toggle{background:transparent;border:none;color:#3498db;cursor:pointer;font-size:12px;padding:0 5px;}
.pagination{margin-top:20px;display:flex;justify-content:center;align-items:center;flex-wrap:wrap;gap:5px;}
.pagination button{padding:6px 12px;margin:0 5px;border:1px solid #3498db;border-radius:4px;background-color:#1e1e1e;color:#3498db;cursor:pointer;transition:background-color 0.3s ease;}
.pagination button.active{background-color:#3498db;color:#ffffff;}
.pagination button:hover{background-color:#3498db;color:#ffffff;}
.no-data{text-align:center;padding:20px;color:#999999;font-size:16px;}
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.7);justify-content:center;align-items:center;z-index:1000;}
.modal-content{background-color:#1e1e1e;padding:20px;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,0.5);max-width:400px;width:90%;text-align:center;border:1px solid #333;}
.modal-content h3{margin-top:0;color:#e0e0e0;}
.modal-content p{color:#999999;}
.modal-content button{padding:8px 16px;background-color:#3498db;color:#ffffff;border:none;border-radius:4px;cursor:pointer;transition:background-color 0.3s ease;margin:0 5px;}
.modal-content button.cancel{background-color:#4a4a4a;}
.modal-content button:hover{background-color:#2980b9;}
.modal-content button.cancel:hover{background-color:#5f5f5f;}
.edit-modal-content{max-width:500px;}
.edit-modal-content .form-group{margin:15px 0;text-align:left;}
.edit-modal-content label{display:block;margin-bottom:5px;color:#e0e0e0;}
.edit-modal-content input{width:100%;padding:8px;border:1px solid #444;border-radius:4px;background-color:#2d2d2d;color:#e0e0e0;box-sizing:border-box;}
.mail-modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.7);justify-content:center;align-items:center;z-index:1000;}
.mail-modal-content{background-color:#1e1e1e;padding:20px;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,0.5);max-width:600px;width:90%;max-height:80vh;overflow-y:auto;position:relative;border:1px solid #333;}
.mail-modal-content h3{margin-top:0;color:#e0e0e0;}
.mail-modal-content p{color:#999999;word-wrap:break-word;}
.mail-modal-content button{padding:8px 16px;background-color:#3498db;color:#ffffff;border:none;border-radius:4px;cursor:pointer;transition:background-color 0.3s ease;position:sticky;bottom:0;width:100%;margin-top:20px;}
.mail-modal-content button:hover{background-color:#2980b9;}
.loading-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.7);justify-content:center;align-items:center;z-index:1000;}
.loading-spinner{border:4px solid #333;border-top:4px solid #3498db;border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite;}
@keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
@keyframes fadeIn{from{opacity:0;}to{opacity:1;}}
.email-handel{display:flex;align-items:center;}
.email-handel .delimiter-input{justify-content:left;margin-top:0px;}
.delete-btn{background-color:#e74c3c !important;margin-left:10px !important;}
.delete-btn:hover{background-color:#e74c3c !important;opacity:0.9 !important;}
.delete-all-btn{background-color:#c0392b !important;margin-left:10px !important;}
.delete-all-btn:hover{background-color:#a5281b !important;opacity:0.9 !important;}
.pagination-section{display:flex;align-items:center;justify-content:center;margin-top:20px;gap:15px;flex-wrap:wrap;}
.pagination-section .pagination{margin-top:0px;}
#items-per-page{padding:6px 15px;border:1px solid #444;border-radius:5px;background-color:#2d2d2d;color:#e0e0e0;font-size:16px;appearance:none;-webkit-appearance:none;-moz-appearance:none;background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="none" stroke="%23e0e0e0" viewBox="0 0 24 24"><path d="M6 9l6 6 6-6"/></svg>');background-repeat:no-repeat;background-position:right 10px center;cursor:pointer;transition:border-color 0.3s ease;}
.export-btn{background-color:#f39c12 !important;margin-left:10px !important;}
.export-btn:hover{background-color:#e67e22 !important;opacity:0.9 !important;}
.batch-group-modal-content{max-width:400px;}
.batch-group-modal-content .form-group{margin:15px 0;text-align:left;}
@media (max-width: 768px) {body{overflow-x:visible;flex-direction:column;}.sidebar{width:100%;height:auto;transform:translateX(-100%);z-index:1000;position:fixed;top:0;left:0;padding:15px;padding-top:60px;}.sidebar.active{transform:translateX(0);}.menu-toggle{display:block;position:fixed;top:10px;left:10px;z-index:1001;}.content{margin-left:0;padding:15px;width:100%;box-sizing:border-box;margin-top:60px;}.sidebar.active + .content{margin-left:0;}.table-container{width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch;}.email-table,.mail-table{min-width:600px;}.email-table th,.email-table td,.mail-table th,.mail-table td{padding:8px 6px;font-size:12px;}.mail-search-section input[type="text"],.search-section input[type="text"],.upload-section .delimiter-input input[type="text"],.upload-section .delimiter-input input[type="password"]{width:100%;margin-right:0;margin-bottom:10px;}.mail-search-section,.search-section,.upload-section .delimiter-input,.group-management{flex-direction:column;align-items:stretch;gap:10px;}.mail-search-section button,.search-section button,.upload-section .delimiter-input button{width:100%;margin-left:0 !important;}.group-management label{margin-left:0 !important;margin-bottom:5px;}.group-management select,.group-management input[type="text"]{width:100%;min-width:unset;}.quick-actions{flex-direction:column;gap:8px;}.quick-actions a{min-width:unset;width:100%;padding:10px;}.dashboard-cards{flex-direction:column;gap:15px;}.dashboard-card{min-width:unset;}.pagination-section{flex-direction:column;gap:10px;}#items-per-page{width:100%;}.modal-content,.mail-modal-content,.edit-modal-content{width:95%;padding:15px;max-height:90vh;}.mail-modal-content{max-height:80vh;overflow-y:auto;}.email-table .actions,.mail-table .actions{flex-direction:column;gap:3px;}.email-table .actions button,.mail-table .actions button{padding:4px 8px;font-size:11px;width:100%;}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/crypto-js@4.2.0/crypto-js.min.js"></script>
</head>
<body>
<button class="menu-toggle" id="menu-toggle"><i class="fas fa-bars"></i></button>
<div class="loading-overlay" id="loading-overlay"><div class="loading-spinner"></div></div>
<div class="sidebar" id="sidebar">
<h2>å¾®è½¯ä¸šåŠ¡ç»¼åˆæœåŠ¡</h2>
<ul>
<li><a href="#" data-target="dashboard" class="active"><i class="fas fa-tachometer-alt"></i>æ‚¨å¾—å¾®è½¯é‚®ç®±æ•°é‡</a></li>
<li><a href="#" data-target="emails" class="buy-link"><i class="fas fa-envelope"></i>å¾®è½¯ä»¤ç‰Œå–ä»¶ç³»ç»Ÿ</a></li>
<li><a href="http://xiaoheiapi.top/" target="_blank" class="buy-link"><i class="fas fa-shopping-cart"></i>é‚®ç®±Apiç”Ÿæˆç³»ç»Ÿ</a></li>
<li><a href="https://xiaoheifk.cn/qj.html" target="_blank" class="buy-link"><i class="fas fa-link"></i>é‚®ç®±APIé•¿é“¾ç”Ÿæˆ</a></li>
<li><a href="https://68n.cn/8to6G" target="_blank" class="buy-link"><i class="fas fa-shopping-cart"></i>è´­ä¹°å¾®è½¯é•¿æ•ˆé‚®ç®±</a></li>
<li><a href="https://hotmuil.com/" target="_blank" class="buy-link"><i class="fas fa-unlock"></i>è‡ªåŠ¨é‚®ç®±è§£é”æäº¤</a></li>
<li><a href="https://68n.cn/rRLdN" target="_blank" class="buy-link"><i class="fas fa-shopping-cart"></i>å¾®è½¯è§£é”å¡å¯†è´­ä¹°</a></li>
<li><a href="https://wwauw.lanzouu.com/ibKMr3h6vpra" target="_blank" class="buy-link"><i class="fas fa-sync-alt"></i>å…è´¹ä»¤ç‰Œåˆ·æ–°å·¥å…·</a></li>
<li><a href="https://wwik.lanzouu.com/iTnxu3anj2tc" target="_blank" class="buy-link"><i class="fas fa-key"></i>å¾®è½¯ä»¤ç‰Œæˆæƒå·¥å…·</a></li>
<li><a href="https://www.qianxun1688.com/rights-shop/1CDFE3FC" target="_blank" class="buy-link"><i class="fas fa-ticket-alt"></i>å…¨ç½‘ä¼šå‘˜5æŠ˜å……å€¼</a></li>
<li><a href="https://xiaoheifk.cn/qc.html" target="_blank" class="buy-link"><i class="fas fa-filter"></i>ç»¼åˆæ•°æ®å¤„ç†å·¥å…·</a></li>
<li><a href="https://xiaoheifk.cn/tk.html" target="_blank" class="buy-link"><i class="fas fa-filter"></i>Tk|å¾®è½¯æ•°æ®å¤„ç†</a></li>
<li><a href="https://xiaoheifk.cn/api.html" target="_blank" class="buy-link"><i class="fas fa-file-alt"></i>api-è°ƒç”¨æ–‡æ¡£æ•™ç¨‹</a></li>
<li><a href="https://link3.cc/hzqds888" target="_blank" class="buy-link"><i class="fas fa-th-large"></i>æ›´å¤šè½¯ä»¶åˆé›†å·¥å…·</a></li>
</ul>
</div>
<div class="content">
<div id="dashboard" class="content-section active">
<h1 style="color: #3498db; font-weight: bold;">é‚®ç®±æ€»æ•°</h1>
<div class="dashboard-cards">
<div class="dashboard-card">
<h3>é‚®ç®±æ•°é‡</h3>
<p id="account-count">0</p>
</div>
</div>
<div class="quick-actions">
<a href="#" data-target="emails"><i class="fas fa-envelope"></i> é‚®ç®±ç®¡ç†</a>
<a href="https://xiaoheifk.cn/dx.html" target="_blank"><i class="fas fa-shopping-cart"></i> äº‘æ³¨å†Œæœº</a>  
<a href="https://68n.cn/8to6G" target="_blank"><i class="fas fa-shopping-cart"></i> è´­ä¹°é‚®ç®±</a>
<a href="https://hotmuil.com" target="_blank"><i class="fas fa-link"></i> è‡ªåŠ¨è§£é”</a>
<a href="https://xiaoheifk.cn/qj.html" target="_blank"><i class="fas fa-link"></i> é‚®ç®±APIç”Ÿæˆ</a>
<a href="https://wwik.lanzouu.com/iq5Mh39ml3sh" target="_blank"><i class="fas fa-sync-alt"></i> ä»¤ç‰Œåˆ·æ–°</a>
<a href="https://wwik.lanzouu.com/iTnxu3anj2tc" target="_blank"><i class="fas fa-key"></i> ä»¤ç‰Œæˆæƒ</a>
<a href="https://link3.cc/hzqds888" target="_blank"><i class="fas fa-th-large"></i> æ›´å¤šå·¥å…·</a>
<a href="https://xiaoheifk.cn/qc.html" target="_blank"><i class="fas fa-filter"></i> æ•°æ®å¤„ç†</a>
<a href="https://xiaoheifk.cn/api.html" target="_blank"><i class="fas fa-file-alt"></i> apiè°ƒç”¨</a>
<a href="https://www.qianxun1688.com/rights-shop/1CDFE3FC" target="_blank"><i class="fas fa-ticket-alt"></i> ä¼šå‘˜ä¼˜æƒ </a>
</div>
</div>
<div id="emails" class="content-section">
<h1 style="color: #3498db; font-weight: bold;">é‚®ç®±ç®¡ç†</h1>
<div class="upload-section">
<div class="upload-box" id="upload-box">
<i class="fas fa-cloud-upload-alt"></i>
<p>ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„ä¸Šä¼ </p>
<div class="file-info" id="file-info"></div>
<input type="file" id="file-input" accept=".txt">
</div>
<div class="delimiter-input">
<input type="password" id="password" placeholder="è¾“å…¥éªŒè¯å¯†ç  è¯·è”ç³»å°é»‘" oninput="setPassword()">
<input type="text" id="delimiter" placeholder="è¾“å…¥åˆ†éš”ç¬¦ï¼ˆå¦‚ ----ï¼‰">
<button onclick="importEmails()">å¯¼å…¥é‚®ç®±</button>
<button class="export-btn" onclick="exportData()">å¯¼å‡ºä¸ºTXT</button>
<button class="delete-btn" onclick="batchDelete()">æ‰¹é‡åˆ é™¤</button>
<button class="delete-all-btn" onclick="deleteAllEmails()">åˆ é™¤å…¨éƒ¨é‚®ç®±</button>
</div>
</div>
<div class="group-management">
<label for="group-filter">åˆ†ç»„ç­›é€‰ï¼š</label>
<select id="group-filter" onchange="filterByGroup()">
<option value="all">å…¨éƒ¨åˆ†ç»„</option>
</select>
<label style="margin-left: 20px;" for="new-group">æ–°å¢åˆ†ç»„ï¼š</label>
<input type="text" id="new-group" placeholder="è¾“å…¥åˆ†ç»„åç§°">
<button onclick="createGroup()">åˆ›å»º</button>
<button class="delete-group" onclick="deleteSelectedGroup()">åˆ é™¤é€‰ä¸­åˆ†ç»„</button>
<label style="margin-left: 20px;" for="batch-group-select">æ‰¹é‡ä¿®æ”¹åˆ†ç»„ï¼š</label>
<select id="batch-group-select">
<option value="">é€‰æ‹©ç›®æ ‡åˆ†ç»„</option>
</select>
<button class="batch-group" onclick="showBatchGroupConfirm()">åº”ç”¨åˆ°é€‰ä¸­é‚®ç®±</button>
</div>
<div class="search-section">
<input type="text" id="email-search" placeholder="è¾“å…¥é‚®ç®±/å¤‡æ³¨å…³é”®è¯æœç´¢...">
<button onclick="searchEmails()">æœç´¢</button>
<button onclick="clearSearch()">æ¸…ç©º</button>
</div>
<div class="table-container">
<table class="email-table" id="email-table">
<thead>
<tr>
<th><input type="checkbox" id="select-all"></th>
<th>Email</th>
<th>Password <button class="password-toggle" onclick="toggleAllPasswords()"><i class="fas fa-eye"></i></button></th>
<th>åˆ†ç»„</th>
<th>å¤‡æ³¨</th>
<th>Client ID</th>
<th>Refresh Token</th>
<th>æ“ä½œ</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>
<div class="no-data" id="no-data">æš‚æ— æ•°æ®</div>
<div class="pagination-section">
<div class="pagination" id="pagination">
<button onclick="changePage(1)">1</button>
</div>
<select id="items-per-page" onchange="changeItemsPerPage(this.value)">
<option value="5">5 æ¡/é¡µ</option>
<option value="10">10 æ¡/é¡µ</option>
<option value="20">20 æ¡/é¡µ</option>
<option value="50">50 æ¡/é¡µ</option>
<option value="100">100 æ¡/é¡µ</option>
<option value="200">200 æ¡/é¡µ</option>
<option value="500">500 æ¡/é¡µ</option>
<option value="5000">5000 æ¡/é¡µ</option>
<option value="10000">10000 æ¡/é¡µ</option>
</select>
</div>
</div>
<div id="mail-list" class="content-section">
<h1>é‚®ä»¶åˆ—è¡¨</h1>
<div class="mail-search-section">
<input type="text" id="mail-search" placeholder="è¾“å…¥å‘ä»¶äººæˆ–ä¸»é¢˜å…³é”®è¯æœç´¢...">
<button onclick="searchMails()">æœç´¢</button>
<button onclick="clearMailSearch()">æ¸…ç©º</button>
</div>
<div class="table-container">
<table class="mail-table" id="mail-table">
<thead>
<tr>
<th>å‘ä»¶äºº</th>
<th>ä¸»é¢˜</th>
<th>æ—¥æœŸ</th>
<th>æ“ä½œ</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>
<div class="no-data" id="no-data-mail">æš‚æ— æ•°æ®</div>
<div class="pagination" id="pagination-mail">
<button onclick="changeMailPage(1)">1</button>
</div>
</div>
</div>
<div class="modal" id="modal">
<div class="modal-content">
<h3 id="modal-title"></h3>
<p id="modal-message"></p>
<button onclick="closeModal()">ç¡®è®¤</button>
</div>
</div>
<div class="modal" id="edit-modal">
<div class="modal-content edit-modal-content">
<h3>ç¼–è¾‘é‚®ç®±ä¿¡æ¯</h3>
<input type="hidden" id="edit-email-original">
<div class="form-group">
<label for="edit-email">é‚®ç®±åœ°å€ï¼ˆä¸å¯ä¿®æ”¹ï¼‰</label>
<input type="text" id="edit-email" readonly>
</div>
<div class="form-group">
<label for="edit-password">å¯†ç </label>
<input type="text" id="edit-password">
</div>
<div class="form-group">
<label for="edit-group">åˆ†ç»„</label>
<select id="edit-group">
<option value="é»˜è®¤åˆ†ç»„">é»˜è®¤åˆ†ç»„</option>
</select>
</div>
<div class="form-group">
<label for="edit-remark">å¤‡æ³¨</label>
<input type="text" id="edit-remark" placeholder="è¾“å…¥å¤‡æ³¨ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰">
</div>
<div class="form-group">
<label for="edit-client-id">Client ID</label>
<input type="text" id="edit-client-id">
</div>
<div class="form-group">
<label for="edit-refresh-token">Refresh Token</label>
<input type="text" id="edit-refresh-token">
</div>
<button onclick="saveEdit()">ä¿å­˜</button>
<button class="cancel" onclick="closeEditModal()">å–æ¶ˆ</button>
</div>
</div>
<div class="modal" id="confirm-modal">
<div class="modal-content">
<h3 id="confirm-title">ç¡®è®¤æ“ä½œ</h3>
<p id="confirm-message"></p>
<button onclick="confirmAction()">ç¡®è®¤</button>
<button class="cancel" onclick="closeConfirmModal()">å–æ¶ˆ</button>
</div>
</div>
<div class="mail-modal" id="mail-modal">
<div class="mail-modal-content">
<h3 id="mail-modal-title"></h3>
<p id="mail-modal-sender"></p>
<p id="mail-modal-subject"></p>
<p id="mail-modal-date"></p>
<p id="mail-modal-content"></p>
<button onclick="closeMailModal()">å…³é—­</button>
</div>
</div>
<div class="modal" id="batch-group-modal">
<div class="modal-content batch-group-modal-content">
<h3>æ‰¹é‡ä¿®æ”¹åˆ†ç»„</h3>
<p>ç¡®å®šè¦å°†é€‰ä¸­çš„ <span id="selected-count">0</span> ä¸ªé‚®ç®±ä¿®æ”¹åˆ°åˆ†ç»„ï¼š<span id="target-group-name">é»˜è®¤åˆ†ç»„</span> å—ï¼Ÿ</p>
<button onclick="confirmBatchGroup()">ç¡®è®¤</button>
<button class="cancel" onclick="closeBatchGroupModal()">å–æ¶ˆ</button>
</div>
</div>
<script>
const ENCRYPT_KEY='xh_email_system_2024';let mailData=[];let originalMailData=[];let currentMailPage=1;const mailItemsPerPage=10;let searchKeyword='';let mailSearchKeyword='';let passwordVisible=false;let confirmCallback=null;let currentGroupFilter='all';
function getGroups(){const encryptedData=localStorage.getItem('emailGroups')||'';if(encryptedData){try{const decrypted=CryptoJS.AES.decrypt(encryptedData,ENCRYPT_KEY).toString(CryptoJS.enc.Utf8);return decrypted&&Array.isArray(JSON.parse(decrypted))?JSON.parse(decrypted):['é»˜è®¤åˆ†ç»„'];}catch(e){return['é»˜è®¤åˆ†ç»„'];}}return['é»˜è®¤åˆ†ç»„'];}
function saveGroups(groups){localStorage.setItem('emailGroups',CryptoJS.AES.encrypt(JSON.stringify(groups),ENCRYPT_KEY).toString());updateGroupSelectors();}
function updateGroupSelectors(){const groups=getGroups();const selectElements=[document.getElementById('group-filter'),document.getElementById('batch-group-select'),document.getElementById('edit-group')];selectElements.forEach(select=>{if(select){const currentValue=select.value;select.innerHTML='';if(select.id==='group-filter'){const allOption=document.createElement('option');allOption.value='all';allOption.textContent='å…¨éƒ¨åˆ†ç»„';select.appendChild(allOption);}else if(select.id==='batch-group-select'){const emptyOption=document.createElement('option');emptyOption.value='';emptyOption.textContent='é€‰æ‹©ç›®æ ‡åˆ†ç»„';select.appendChild(emptyOption);}groups.forEach(group=>{const option=document.createElement('option');option.value=group;option.textContent=group;select.appendChild(option);});if(currentValue&&(select.id==='group-filter'||groups.includes(currentValue))){select.value=currentValue;}}});}
document.addEventListener('DOMContentLoaded',function(){initSidebarLinks();initQuickActions();initSelectAll();initDragUpload();initSearchEnter();initGroups();loadData();initWindowResize();initDevInfo();});
function initGroups(){const groups=getGroups();if(!groups.includes('é»˜è®¤åˆ†ç»„')){groups.unshift('é»˜è®¤åˆ†ç»„');saveGroups(groups);}updateGroupSelectors();}
function initSidebarLinks(){document.querySelectorAll('.sidebar ul li a').forEach(link=>{link.addEventListener('click',function(e){if(this.hasAttribute('target')&&this.target==='_blank'){return;}e.preventDefault();document.querySelectorAll('.sidebar ul li a').forEach(l=>l.classList.remove('active'));this.classList.add('active');const targetId=this.getAttribute('data-target');if(!targetId)return;document.querySelectorAll('.content-section').forEach(section=>{section.classList.remove('active');});const targetSection=document.getElementById(targetId);if(targetSection){targetSection.classList.add('active');}if(window.innerWidth<=768){document.getElementById('sidebar').classList.remove('active');}});});}
function initQuickActions(){document.querySelectorAll('.quick-actions a').forEach(link=>{link.addEventListener('click',function(e){if(this.hasAttribute('target')&&this.target==='_blank'){return;}e.preventDefault();const targetId=this.getAttribute('data-target');if(!targetId)return;document.querySelectorAll('.sidebar ul li a').forEach(l=>l.classList.remove('active'));document.querySelector(`.sidebar ul li a[data-target="${targetId}"]`).classList.add('active');document.querySelectorAll('.content-section').forEach(section=>{section.classList.remove('active');});const targetSection=document.getElementById(targetId);if(targetSection){targetSection.classList.add('active');}});});}
document.getElementById('menu-toggle').addEventListener('click',function(){const sidebar=document.getElementById('sidebar');sidebar.classList.toggle('active');const content=document.querySelector('.content');content.classList.toggle('active-content');});
document.addEventListener('click',function(e){const sidebar=document.getElementById('sidebar');const menuToggle=document.getElementById('menu-toggle');if(!sidebar.contains(e.target)&&e.target!==menuToggle){sidebar.classList.remove('active');document.querySelector('.content').classList.remove('active-content');}});
document.addEventListener('touchstart',function(e){const startX=e.touches[0].clientX;document.addEventListener('touchmove',function(e){const currentX=e.touches[0].clientX;if(currentX-startX>20&&document.getElementById('sidebar').classList.contains('active')){document.getElementById('sidebar').classList.remove('active');document.querySelector('.content').classList.remove('active-content');}});});
function encryptData(data){return CryptoJS.AES.encrypt(JSON.stringify(data),ENCRYPT_KEY).toString();}
function decryptData(cipherText){try{const bytes=CryptoJS.AES.decrypt(cipherText,ENCRYPT_KEY);return JSON.parse(bytes.toString(CryptoJS.enc.Utf8));}catch(e){return null;}}
function showLoading(){document.getElementById('loading-overlay').style.display='flex';}
function hideLoading(){document.getElementById('loading-overlay').style.display='none';}
let currentPage=1;let itemsPerPage=5;
function loadData(){const encryptedData=localStorage.getItem('emailData')||'';let data=[];if(encryptedData){data=decryptData(encryptedData)||[];}data=data.map(item=>({group:item.group||'é»˜è®¤åˆ†ç»„',remark:item.remark||'',...item}));localStorage.setItem('emailData',encryptData(data));const encryptedPassword=localStorage.getItem('password')||'';if(encryptedPassword){const decryptedPwd=decryptData(encryptedPassword);if(decryptedPwd){document.getElementById('password').value=decryptedPwd;}}let filteredData=data;if(currentGroupFilter!=='all'){filteredData=filteredData.filter(item=>item.group===currentGroupFilter);}if(searchKeyword){filteredData=filteredData.filter(item=>item.email.toLowerCase().includes(searchKeyword)||item.remark.toLowerCase().includes(searchKeyword));}renderTable(filteredData);renderPagination(filteredData.length);toggleNoData(filteredData.length===0);updateDashboard(data);}
function renderTable(data){const emailTableBody=document.querySelector('#email-table tbody');emailTableBody.innerHTML='';const start=(currentPage-1)*itemsPerPage;const end=start+itemsPerPage;const pageData=data.slice(start,end);pageData.forEach((item,index)=>{const row=document.createElement('tr');const checkboxCell=document.createElement('td');const checkbox=document.createElement('input');checkbox.type='checkbox';checkbox.dataset.email=item.email;checkboxCell.appendChild(checkbox);row.appendChild(checkboxCell);const passwordCell=document.createElement('td');passwordCell.className='password-cell';const passwordSpan=document.createElement('span');passwordSpan.className='password-text';passwordSpan.textContent=passwordVisible?item.password:'â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢';const toggleBtn=document.createElement('button');toggleBtn.className='password-toggle';toggleBtn.innerHTML=passwordVisible?'<i class="fas fa-eye-slash"></i>':'<i class="fas fa-eye"></i>';toggleBtn.onclick=(e)=>{e.stopPropagation();const isVisible=passwordSpan.textContent!=='â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢';passwordSpan.textContent=isVisible?'â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢':item.password;toggleBtn.innerHTML=isVisible?'<i class="fas fa-eye"></i>':'<i class="fas fa-eye-slash"></i>';};passwordCell.appendChild(passwordSpan);passwordCell.appendChild(toggleBtn);row.appendChild(document.createElement('td')).textContent=item.email;row.appendChild(passwordCell);row.appendChild(document.createElement('td')).textContent=item.group||'é»˜è®¤åˆ†ç»„';const remarkCell=document.createElement('td');remarkCell.className='remark-cell';remarkCell.title=item.remark||'æ— å¤‡æ³¨';remarkCell.textContent=item.remark||'æ— å¤‡æ³¨';row.appendChild(remarkCell);row.appendChild(document.createElement('td')).textContent=item.clientId;const refreshTokenCell=document.createElement('td');refreshTokenCell.className='refresh-token';refreshTokenCell.title=item.refreshToken;refreshTokenCell.textContent=item.refreshToken;row.appendChild(refreshTokenCell);const actionsCell=document.createElement('td');actionsCell.className='actions';actionsCell.innerHTML=`
<button class="view" onclick="viewInbox(${start + index})">æ”¶ä»¶ç®±</button>
<button class="view" onclick="viewJunk(${start + index})">åƒåœ¾ç®±</button>
<button class="edit" onclick="editEmail(${start + index})">ç¼–è¾‘</button>
<button class="delete" onclick="showDeleteConfirm(${start + index})">åˆ é™¤</button>
`;row.appendChild(actionsCell);emailTableBody.appendChild(row);});}
function initSelectAll(){document.getElementById('select-all').addEventListener('change',function(){const checkboxes=document.querySelectorAll('#email-table tbody input[type="checkbox"]');checkboxes.forEach(checkbox=>{checkbox.checked=this.checked;});updateSelectedItems();});document.querySelector('#email-table tbody').addEventListener('change',function(event){if(event.target.type==='checkbox'){updateSelectedItems();}});}
let selectedItems=[];
function updateSelectedItems(){const checkboxes=document.querySelectorAll('#email-table tbody input[type="checkbox"]:checked');selectedItems=Array.from(checkboxes).map(checkbox=>{return checkbox.dataset.email;});}
function batchDelete(){if(selectedItems.length===0){showModal('æç¤º','è¯·é€‰æ‹©è¦åˆ é™¤çš„é¡¹ï¼');return;}showConfirmModal('ç¡®è®¤æ‰¹é‡åˆ é™¤',`ç¡®å®šè¦åˆ é™¤é€‰ä¸­çš„ ${selectedItems.length} é¡¹å—ï¼Ÿåˆ é™¤åä¸å¯æ¢å¤`,function(){const encryptedData=localStorage.getItem('emailData')||'';let data=encryptedData?decryptData(encryptedData)||[]:[];const filteredData=data.filter(item=>!selectedItems.includes(item.email));localStorage.setItem('emailData',encryptData(filteredData));loadData();showModal('åˆ é™¤æˆåŠŸ',`å·²åˆ é™¤é€‰ä¸­çš„ ${selectedItems.length} é¡¹é‚®ç®±`);});}
function deleteAllEmails(){const encryptedData=localStorage.getItem('emailData')||'';let data=encryptedData?decryptData(encryptedData)||[]:[];if(data.length===0){showModal('æç¤º','å½“å‰æ²¡æœ‰é‚®ç®±æ•°æ®å¯åˆ é™¤ï¼');return;}showConfirmModal('è­¦å‘Š','æ­¤æ“ä½œå°†åˆ é™¤æ‰€æœ‰é‚®ç®±æ•°æ®ï¼Œä¸”æ— æ³•æ¢å¤ã€‚æ˜¯å¦ç¡®è®¤åˆ é™¤ï¼Ÿ',function(){localStorage.removeItem('emailData');loadData();showModal('åˆ é™¤æˆåŠŸ','æ‰€æœ‰é‚®ç®±æ•°æ®å·²å…¨éƒ¨åˆ é™¤ï¼');});}
function renderPagination(totalItems){const pagination=document.getElementById('pagination');pagination.innerHTML='';const totalPages=Math.ceil(totalItems/itemsPerPage);const maxButtons=5;let startPage=Math.max(1,currentPage-Math.floor(maxButtons/2));let endPage=Math.min(totalPages,startPage+maxButtons-1);if(endPage-startPage+1<maxButtons){startPage=Math.max(1,endPage-maxButtons+1);}if(currentPage>1){const prevButton=document.createElement('button');prevButton.textContent='ä¸Šä¸€é¡µ';prevButton.onclick=()=>changePage(currentPage-1);pagination.appendChild(prevButton);}if(startPage>1){const firstButton=document.createElement('button');firstButton.textContent='1';firstButton.onclick=()=>changePage(1);pagination.appendChild(firstButton);if(startPage>2){const ellipsis=document.createElement('span');ellipsis.textContent='...';pagination.appendChild(ellipsis);}}for(let i=startPage;i<=endPage;i++){const button=document.createElement('button');button.textContent=i;if(i===currentPage){button.classList.add('active');}button.onclick=()=>changePage(i);pagination.appendChild(button);}if(endPage<totalPages){if(endPage<totalPages-1){const ellipsis=document.createElement('span');ellipsis.textContent='...';pagination.appendChild(ellipsis);}const lastButton=document.createElement('button');lastButton.textContent=totalPages;lastButton.onclick=()=>changePage(totalPages);pagination.appendChild(lastButton);}if(currentPage<totalPages){const nextButton=document.createElement('button');nextButton.textContent='ä¸‹ä¸€é¡µ';nextButton.onclick=()=>changePage(currentPage+1);pagination.appendChild(nextButton);}}
function changePage(page){currentPage=page;const encryptedData=localStorage.getItem('emailData')||'';let data=encryptedData?decryptData(encryptedData)||[]:[];let filteredData=data;if(currentGroupFilter!=='all'){filteredData=filteredData.filter(item=>item.group===currentGroupFilter);}if(searchKeyword){filteredData=filteredData.filter(item=>item.email.toLowerCase().includes(searchKeyword)||item.remark.toLowerCase().includes(searchKeyword));}renderTable(filteredData);renderPagination(filteredData.length);}
function changeItemsPerPage(value){itemsPerPage=parseInt(value,10);currentPage=1;const encryptedData=localStorage.getItem('emailData')||'';let data=encryptedData?decryptData(encryptedData)||[]:[];let filteredData=data;if(currentGroupFilter!=='all'){filteredData=filteredData.filter(item=>item.group===currentGroupFilter);}if(searchKeyword){filteredData=filteredData.filter(item=>item.email.toLowerCase().includes(searchKeyword)||item.remark.toLowerCase().includes(searchKeyword));}renderTable(filteredData);renderPagination(filteredData.length);}
function toggleNoData(isEmpty){const noData=document.getElementById('no-data');noData.style.display=isEmpty?'block':'none';}
function viewInbox(index){const encryptedData=localStorage.getItem('emailData')||'';let data=encryptedData?decryptData(encryptedData)||[]:[];let filteredData=data;if(currentGroupFilter!=='all'){filteredData=filteredData.filter(item=>item.group===currentGroupFilter);}if(searchKeyword){filteredData=filteredData.filter(item=>item.email.toLowerCase().includes(searchKeyword)||item.remark.toLowerCase().includes(searchKeyword));}const item=filteredData[index];currentMailPage=1;mailSearchKeyword='';document.getElementById('mail-search').value='';loadMailList(item.refreshToken,item.clientId,item.email,'INBOX');}
function viewJunk(index){const encryptedData=localStorage.getItem('emailData')||'';let data=encryptedData?decryptData(encryptedData)||[]:[];let filteredData=data;if(currentGroupFilter!=='all'){filteredData=filteredData.filter(item=>item.group===currentGroupFilter);}if(searchKeyword){filteredData=filteredData.filter(item=>item.email.toLowerCase().includes(searchKeyword)||item.remark.toLowerCase().includes(searchKeyword));}const item=filteredData[index];currentMailPage=1;mailSearchKeyword='';document.getElementById('mail-search').value='';loadMailList(item.refreshToken,item.clientId,item.email,'Junk');}
function loadMailList(refreshToken,clientId,email,mailbox){showLoading();const encryptedPassword=localStorage.getItem('password')||'';let password='';if(encryptedPassword){const decryptedPwd=decryptData(encryptedPassword);password=decryptedPwd||'';}const apiUrl=`/api/mail-all?refresh_token=${refreshToken}&client_id=${clientId}&email=${email}&mailbox=${mailbox}&response_type=json&password=${password}`;fetch(apiUrl).then(response=>{if(!response.ok){if(response.status===500){return response.json().then(errorData=>{if(errorData.error==="Nothing to fetch"){mailData=[];originalMailData=[];document.querySelectorAll('.content-section').forEach(section=>section.classList.remove('active'));document.getElementById('mail-list').classList.add('active');renderMailTable(mailData);return Promise.resolve();}else{throw new Error('æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•ã€‚');}});}else{if(response.status===401){throw response;}throw new Error(`è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç ï¼š${response.status}`);}}return response.json();}).then(data=>{if(data){mailData=data;originalMailData=[...data];document.querySelectorAll('.content-section').forEach(section=>section.classList.remove('active'));document.getElementById('mail-list').classList.add('active');renderMailTable(mailData);}}).catch(error=>{if(error.status===401){showModal('æç¤º','å·²åŠ å¯†ç éªŒè¯ã€‚å¦‚éœ€ä½¿ç”¨è¯·å¡ç½‘è´­ä¹°68ä¸€å¹´æˆ–ä¸‡èµ·è´­å·å…è´¹æä¾›ä½¿ç”¨ï¼Œè¯·è”ç³»ç®¡ç†å‘˜å°é»‘QQï¼š113575320ã€‚');return;}if(error.message.includes('æœåŠ¡å™¨å†…éƒ¨é”™è¯¯')){showModal('é”™è¯¯','æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•ã€‚');}else{showModal('é”™è¯¯','æ— æ³•åŠ è½½é‚®ä»¶æ•°æ®ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•ã€‚');}}).finally(()=>{hideLoading();});}
function renderMailTable(data){const mailTableBody=document.querySelector('#mail-table tbody');mailTableBody.innerHTML='';if(data.length===0){document.getElementById('no-data-mail').style.display='block';}else{document.getElementById('no-data-mail').style.display='none';}const start=(currentMailPage-1)*mailItemsPerPage;const end=start+mailItemsPerPage;const pageData=data.slice(start,end);pageData.forEach((item,index)=>{const row=document.createElement('tr');row.innerHTML=`
<td>${item.send}</td>
<td>${item.subject}</td>
<td>${item.date}</td>
<td class="actions">
<button onclick="viewMail(${start + index})">æŸ¥çœ‹</button>
</td>
`;mailTableBody.appendChild(row);});renderMailPagination(data.length);}
function renderMailPagination(totalItems){const pagination=document.getElementById('pagination-mail');pagination.innerHTML='';const totalPages=Math.ceil(totalItems/mailItemsPerPage);for(let i=1;i<=totalPages;i++){const button=document.createElement('button');button.textContent=i;if(i===currentMailPage){button.classList.add('active');}button.onclick=()=>changeMailPage(i);pagination.appendChild(button);}}
function changeMailPage(page){currentMailPage=page;const renderData=mailSearchKeyword?originalMailData.filter(item=>item.send.toLowerCase().includes(mailSearchKeyword)||item.subject.toLowerCase().includes(mailSearchKeyword)):originalMailData;renderMailTable(renderData);}
function searchMails(){mailSearchKeyword=document.getElementById('mail-search').value.trim().toLowerCase();currentMailPage=1;const filteredData=originalMailData.filter(item=>item.send.toLowerCase().includes(mailSearchKeyword)||item.subject.toLowerCase().includes(mailSearchKeyword));renderMailTable(filteredData);}
function clearMailSearch(){document.getElementById('mail-search').value='';mailSearchKeyword='';currentMailPage=1;renderMailTable(originalMailData);}
function viewMail(index){const targetData=mailSearchKeyword?originalMailData.filter(item=>item.send.toLowerCase().includes(mailSearchKeyword)||item.subject.toLowerCase().includes(mailSearchKeyword))[index]:originalMailData[index];if(targetData){document.getElementById('mail-modal-title').textContent=targetData.subject;document.getElementById('mail-modal-sender').textContent=`å‘ä»¶äºº: ${targetData.send}`;document.getElementById('mail-modal-subject').textContent=`ä¸»é¢˜: ${targetData.subject}`;document.getElementById('mail-modal-date').textContent=`æ—¥æœŸ: ${targetData.date}`;document.getElementById('mail-modal-content').innerHTML=`å†…å®¹: ${targetData.html || targetData.text}`;document.getElementById('mail-modal').style.display='flex';}else{console.error('é‚®ä»¶æ•°æ®ä¸å­˜åœ¨:',index);}}
function closeMailModal(){document.getElementById('mail-modal').style.display='none';}
function showDeleteConfirm(index){confirmCallback=function(){deleteEmail(index);};document.getElementById('confirm-title').textContent='ç¡®è®¤åˆ é™¤';document.getElementById('confirm-message').textContent='ç¡®å®šè¦åˆ é™¤è¯¥é‚®ç®±å—ï¼Ÿåˆ é™¤åä¸å¯æ¢å¤';document.getElementById('confirm-modal').style.display='flex';}
function deleteEmail(index){const encryptedData=localStorage.getItem('emailData')||'';let data=encryptedData?decryptData(encryptedData)||[]:[];let filteredData=data;if(currentGroupFilter!=='all'){filteredData=filteredData.filter(item=>item.group===currentGroupFilter);}if(searchKeyword){filteredData=filteredData.filter(item=>item.email.toLowerCase().includes(searchKeyword)||item.remark.toLowerCase().includes(searchKeyword));}const originalIndex=data.findIndex(item=>item.email===filteredData[index].email);if(originalIndex!==-1){const deletedEmail=data[originalIndex].email;data.splice(originalIndex,1);localStorage.setItem('emailData',encryptData(data));loadData();showModal('åˆ é™¤æˆåŠŸ',`é‚®ç®± ${deletedEmail} å·²æˆåŠŸåˆ é™¤`);}}
function importEmails(){const delimiter=document.getElementById('delimiter').value.trim();const fileInput=document.getElementById('file-input');if(!delimiter){showModal('é”™è¯¯','è¯·è¾“å…¥åˆ†éš”ç¬¦ï¼');return;}if(fileInput.files.length===0){showModal('é”™è¯¯','è¯·é€‰æ‹©æ–‡ä»¶ï¼');return;}const file=fileInput.files[0];const reader=new FileReader();reader.onload=function(e){showLoading();const content=e.target.result;const lines=content.split('\n').filter(line=>line.trim()!=='');const encryptedData=localStorage.getItem('emailData')||'';let data=encryptedData?decryptData(encryptedData)||[]:[];const existingEmails=new Set(data.map(item=>item.email.toLowerCase()));let successCount=0;let duplicateCount=0;let errorCount=0;lines.forEach(line=>{const fields=line.split(delimiter).map(field=>field.trim());if(fields.length>=4){const email=fields[0].trim();const password=fields[1].trim();let group='é»˜è®¤åˆ†ç»„';let remark='';let clientId='';let refreshToken='';if(fields.length>=6){group=fields[2].trim()||'é»˜è®¤åˆ†ç»„';remark=fields[3].trim();clientId=fields[4].trim();refreshToken=fields[5].trim();}else{clientId=fields[2].trim();refreshToken=fields[3].trim();}if(email&&password&&clientId&&refreshToken){if(existingEmails.has(email.toLowerCase())){duplicateCount++;return;}const groups=getGroups();if(!groups.includes(group)){groups.push(group);saveGroups(groups);}data.push({email,password,group,remark,clientId,refreshToken});existingEmails.add(email.toLowerCase());successCount++;}else{errorCount++;}}else{errorCount++;}});localStorage.setItem('emailData',encryptData(data));loadData();hideLoading();showModal('å¯¼å…¥å®Œæˆ',`æˆåŠŸå¯¼å…¥ï¼š${successCount} æ¡<br>é‡å¤è·³è¿‡ï¼š${duplicateCount} æ¡<br>æ ¼å¼é”™è¯¯ï¼š${errorCount} æ¡`);fileInput.value='';document.getElementById('file-info').textContent='';};reader.readAsText(file);}
function initDragUpload(){const uploadBox=document.getElementById('upload-box');const fileInput=document.getElementById('file-input');const fileInfo=document.getElementById('file-info');uploadBox.addEventListener('click',()=>{fileInput.click();});fileInput.addEventListener('change',()=>{if(fileInput.files.length>0){fileInfo.textContent=`å·²é€‰æ‹©æ–‡ä»¶ï¼š${fileInput.files[0].name}`;}});uploadBox.addEventListener('dragover',(e)=>{e.preventDefault();uploadBox.classList.add('dragover');});uploadBox.addEventListener('dragleave',()=>{uploadBox.classList.remove('dragover');});uploadBox.addEventListener('drop',(e)=>{e.preventDefault();uploadBox.classList.remove('dragover');const files=e.dataTransfer.files;if(files.length>0){fileInput.files=files;fileInfo.textContent=`å·²é€‰æ‹©æ–‡ä»¶ï¼š${files[0].name}`;}});}
const modal=document.getElementById('modal');const confirmModal=document.getElementById('confirm-modal');const editModal=document.getElementById('edit-modal');const batchGroupModal=document.getElementById('batch-group-modal');
function showModal(title,message){document.getElementById('modal-title').textContent=title;document.getElementById('modal-message').innerHTML=message;modal.style.display='flex';}
function showConfirmModal(title,message,callback){confirmCallback=callback;document.getElementById('confirm-title').textContent=title;document.getElementById('confirm-message').textContent=message;confirmModal.style.display='flex';}
function confirmAction(){if(typeof confirmCallback==='function'){confirmCallback();}closeConfirmModal();}
function closeModal(){modal.style.display='none';}
function closeConfirmModal(){confirmModal.style.display='none';confirmCallback=null;}
function editEmail(index){const encryptedData=localStorage.getItem('emailData')||'';let data=encryptedData?decryptData(encryptedData)||[]:[];let filteredData=data;if(currentGroupFilter!=='all'){filteredData=filteredData.filter(item=>item.group===currentGroupFilter);}if(searchKeyword){filteredData=filteredData.filter(item=>item.email.toLowerCase().includes(searchKeyword)||item.remark.toLowerCase().includes(searchKeyword));}const item=filteredData[index];if(item){document.getElementById('edit-email-original').value=item.email;document.getElementById('edit-email').value=item.email;document.getElementById('edit-password').value=item.password;document.getElementById('edit-client-id').value=item.clientId;document.getElementById('edit-refresh-token').value=item.refreshToken;document.getElementById('edit-remark').value=item.remark||'';updateGroupSelectors();document.getElementById('edit-group').value=item.group||'é»˜è®¤åˆ†ç»„';editModal.style.display='flex';}}
function closeEditModal(){editModal.style.display='none';}
function saveEdit(){const originalEmail=document.getElementById('edit-email-original').value.trim();const password=document.getElementById('edit-password').value.trim();const clientId=document.getElementById('edit-client-id').value.trim();const refreshToken=document.getElementById('edit-refresh-token').value.trim();const group=document.getElementById('edit-group').value.trim();const remark=document.getElementById('edit-remark').value.trim();if(!password||!clientId||!refreshToken||!group){showModal('é”™è¯¯','å¯†ç ã€Client IDã€Refresh Tokenã€åˆ†ç»„ä¸èƒ½ä¸ºç©ºï¼');return;}const encryptedData=localStorage.getItem('emailData')||'';let data=encryptedData?decryptData(encryptedData)||[]:[];const index=data.findIndex(item=>item.email===originalEmail);if(index!==-1){data[index].password=password;data[index].clientId=clientId;data[index].refreshToken=refreshToken;data[index].group=group;data[index].remark=remark;localStorage.setItem('emailData',encryptData(data));loadData();closeEditModal();showModal('ç¼–è¾‘æˆåŠŸ',`é‚®ç®± ${originalEmail} ä¿¡æ¯å·²æ›´æ–°`);}else{showModal('é”™è¯¯','æœªæ‰¾åˆ°è¯¥é‚®ç®±æ•°æ®ï¼');}}
function exportData(){const encryptedData=localStorage.getItem('emailData')||'';let data=encryptedData?decryptData(encryptedData)||[]:[];if(data.length===0){showModal('æç¤º','å½“å‰æ²¡æœ‰é‚®ç®±æ•°æ®å¯å¯¼å‡ºï¼');return;}const txtContent=data.map(item=>`${item.email}----${item.password}----${item.group||'é»˜è®¤åˆ†ç»„'}----${item.remark||''}----${item.clientId}----${item.refreshToken}`).join('\n');const blob=new Blob([txtContent],{type:'text/plain'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=`é‚®ç®±æ•°æ®å¤‡ä»½_${new Date().toLocaleDateString().replace(/\//g,'-')}.txt`;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);showModal('å¯¼å‡ºæˆåŠŸ','æ•°æ®å·²å¯¼å‡ºä¸ºTXTæ–‡ä»¶ï¼ˆæ ¼å¼ï¼šé‚®ç®±----å¯†ç ----åˆ†ç»„----å¤‡æ³¨----Client ID----Refresh Tokenï¼‰');}
function toggleAllPasswords(){passwordVisible=!passwordVisible;const passwordTexts=document.querySelectorAll('.password-text');const toggleBtns=document.querySelectorAll('.password-toggle:not(.edit-modal-content .password-toggle)');passwordTexts.forEach((span,index)=>{const row=span.closest('tr');const email=row.cells[1].textContent;const encryptedData=localStorage.getItem('emailData')||'';let data=encryptedData?decryptData(encryptedData)||[]:[];const item=data.find(item=>item.email===email);if(item){span.textContent=passwordVisible?item.password:'â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢';}toggleBtns[index].innerHTML=passwordVisible?'<i class="fas fa-eye-slash"></i>':'<i class="fas fa-eye"></i>';});const headerBtn=document.querySelector('th .password-toggle i');headerBtn.className=passwordVisible?'fas fa-eye-slash':'fas fa-eye';}
function animateValue(id,start,end,duration){let startTimestamp=null;const element=document.getElementById(id);const step=(timestamp)=>{if(!startTimestamp)startTimestamp=timestamp;const progress=Math.min((timestamp-startTimestamp)/duration,1);const value=Math.floor(progress*(end-start)+start);element.textContent=value;if(progress<1){window.requestAnimationFrame(step);}};window.requestAnimationFrame(step);}
function updateDashboard(data){const countElement=document.getElementById('account-count');const currentValue=parseInt(countElement.textContent)||0;const targetValue=data.length;if(currentValue!==targetValue){animateValue('account-count',currentValue,targetValue,1000);}}
function searchEmails(){searchKeyword=document.getElementById('email-search').value.trim().toLowerCase();currentPage=1;loadData();}
function clearSearch(){document.getElementById('email-search').value='';searchKeyword='';currentPage=1;loadData();}
function setPassword(){const password=document.getElementById('password').value;if(password){localStorage.setItem('password',encryptData(password));}else{localStorage.removeItem('password');}}
function initSearchEnter(){document.getElementById('email-search').addEventListener('keypress',function(e){if(e.key==='Enter'){searchEmails();}});document.getElementById('mail-search').addEventListener('keypress',function(e){if(e.key==='Enter'){searchMails();}});}
function initWindowResize(){window.addEventListener('resize',function(){if(window.innerWidth>768){document.getElementById('sidebar').classList.remove('active');}});}
function initDevInfo(){console.log('å°é»‘é‚®ç®±ç®¡ç†ç³»ç»Ÿ - å¼€å‘è€…QQ:113575320');}
function createGroup(){const newGroupName=document.getElementById('new-group').value.trim();if(!newGroupName){showModal('é”™è¯¯','åˆ†ç»„åç§°ä¸èƒ½ä¸ºç©ºï¼');return;}const groups=getGroups();if(groups.includes(newGroupName)){showModal('é”™è¯¯','è¯¥åˆ†ç»„å·²å­˜åœ¨ï¼');return;}groups.push(newGroupName);saveGroups(groups);document.getElementById('new-group').value='';showModal('æˆåŠŸ','åˆ†ç»„åˆ›å»ºæˆåŠŸï¼');}
function deleteSelectedGroup(){const selectedGroup=document.getElementById('group-filter').value;if(selectedGroup==='all'||selectedGroup==='é»˜è®¤åˆ†ç»„'){showModal('é”™è¯¯','ä¸èƒ½åˆ é™¤"å…¨éƒ¨åˆ†ç»„"æˆ–"é»˜è®¤åˆ†ç»„"ï¼');return;}const groups=getGroups();const groupIndex=groups.indexOf(selectedGroup);if(groupIndex===-1){showModal('é”™è¯¯','é€‰ä¸­çš„åˆ†ç»„ä¸å­˜åœ¨ï¼');return;}const encryptedData=localStorage.getItem('emailData')||'';const data=encryptedData?decryptData(encryptedData)||[]:[];const hasEmailsInGroup=data.some(item=>item.group===selectedGroup);if(hasEmailsInGroup){showConfirmModal('ç¡®è®¤åˆ é™¤åˆ†ç»„','è¯¥åˆ†ç»„ä¸‹å­˜åœ¨é‚®ç®±ï¼Œåˆ é™¤åè¿™äº›é‚®ç®±å°†è‡ªåŠ¨ç§»åˆ°"é»˜è®¤åˆ†ç»„"ã€‚æ˜¯å¦ç¡®è®¤åˆ é™¤ï¼Ÿ',function(){const updatedData=data.map(item=>{if(item.group===selectedGroup){return {...item,group:'é»˜è®¤åˆ†ç»„'};}return item;});localStorage.setItem('emailData',encryptData(updatedData));groups.splice(groupIndex,1);saveGroups(groups);currentGroupFilter='all';document.getElementById('group-filter').value='all';loadData();showModal('æˆåŠŸ','åˆ†ç»„å·²åˆ é™¤ï¼Œç›¸å…³é‚®ç®±å·²ç§»åˆ°é»˜è®¤åˆ†ç»„ï¼');});}else{showConfirmModal('ç¡®è®¤åˆ é™¤åˆ†ç»„','ç¡®å®šè¦åˆ é™¤è¯¥åˆ†ç»„å—ï¼Ÿ',function(){groups.splice(groupIndex,1);saveGroups(groups);currentGroupFilter='all';document.getElementById('group-filter').value='all';loadData();showModal('æˆåŠŸ','åˆ†ç»„å·²åˆ é™¤ï¼');});}}
function filterByGroup(){currentGroupFilter=document.getElementById('group-filter').value;currentPage=1;loadData();}
function showBatchGroupConfirm(){const targetGroup=document.getElementById('batch-group-select').value;if(!targetGroup){showModal('é”™è¯¯','è¯·é€‰æ‹©ç›®æ ‡åˆ†ç»„ï¼');return;}if(selectedItems.length===0){showModal('é”™è¯¯','è¯·é€‰æ‹©è¦ä¿®æ”¹çš„é‚®ç®±ï¼');return;}document.getElementById('selected-count').textContent=selectedItems.length;document.getElementById('target-group-name').textContent=targetGroup;batchGroupModal.style.display='flex';}
function confirmBatchGroup(){const targetGroup=document.getElementById('batch-group-select').value;const encryptedData=localStorage.getItem('emailData')||'';let data=encryptedData?decryptData(encryptedData)||[]:[];const updatedData=data.map(item=>{if(selectedItems.includes(item.email)){return {...item,group:targetGroup};}return item;});localStorage.setItem('emailData',encryptData(updatedData));closeBatchGroupModal();loadData();showModal('æˆåŠŸ',`å·²å°†é€‰ä¸­çš„ ${selectedItems.length} ä¸ªé‚®ç®±ä¿®æ”¹åˆ°åˆ†ç»„ï¼š${targetGroup}`);}
function closeBatchGroupModal(){batchGroupModal.style.display='none';}
</script>
</body>
</html>
