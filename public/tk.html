<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>小黑综合工具</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script>tailwind.config={theme:{extend:{colors:{primary:'#3B82F6',original:'#10B981',shuffled:'#F59E0B',result:'#8B5CF6',duplicate:'#EF4444',unmatched:'#F97316',noemail:'#6B7280',dedupe:'#EC4899'}}}};</script>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:"微软雅黑",sans-serif;}
body{background:#000;color:#e0e0e0;min-h-screen;padding-top:70px;}
.top-fixed-bar{position:fixed;top:0;left:0;right:0;height:70px;background:#111;border-bottom:1px solid #3B82F6;display:flex;align-items:center;justify-content:space-between;padding:0 20px;z-index:9999;box-shadow:0 2px 12px rgba(0,0,0,0.8);}
.tool-title{color:#fff;font-size:18px;font-weight:600;letter-spacing:1px;}
.buy-btn{background:linear-gradient(135deg, #3B82F6 0%, #2563EB 100%);color:white;padding:10px 28px;border-radius:8px;text-decoration:none;font-size:15px;font-weight:600;transition:all 0.3s ease;box-shadow:0 4px 12px rgba(59, 130, 246, 0.4);border:1px solid #4F46E5;cursor:pointer;pointer-events:auto;position:relative;z-index:10000;}
.buy-btn:hover{transform:translateY(-2px);box-shadow:0 6px 18px rgba(59, 130, 246, 0.6);background:linear-gradient(135deg, #2563EB 0%, #1D4ED8 100%);}
@media (max-width:768px){.tool-title{font-size:14px;}.buy-btn{padding:8px 18px;font-size:13px;}}
.tab-container{max-width:1200px;margin:0 auto;padding:20px 15px;}
.tabs{display:flex;border-bottom:1px solid #333;overflow-x:auto;margin-bottom:20px;padding-bottom:5px;}
.tab{padding:12px 20px;cursor:pointer;border-bottom:2px solid transparent;white-space:nowrap;transition:all 0.2s;color:#ccc;margin-right:5px;}
.tab.active{border-bottom-color:#007bff;color:#007bff;font-weight:500;}
.tab-content{display:none;}
.tab-content.active{display:block;}
textarea,input[type="text"],input[type="number"],input[type="password"]{width:100%;padding:8px 10px;border:1px solid #333;border-radius:4px;background:#111;color:#fff;resize:vertical;font-size:14px;}
.btn-group button{padding:9px 16px;margin-right:10px;border:none;border-radius:4px;cursor:pointer;font-size:14px;transition:background-color 0.2s;}
.btn-group button:nth-child(1){background:#007bff;color:white;}
.btn-group button:nth-child(1):hover{background:#0069d9;}
.btn-group button:nth-child(2){background:#dc3545;color:white;}
.btn-group button:nth-child(2):hover{background:#c82333;}
.btn-group button:nth-child(3){background:#28a745;color:white;}
.btn-group button:nth-child(3):hover{background:#218838;}
.btn-group button:nth-child(4){background:#6c757d;color:white;}
.btn-group button:nth-child(4):hover{background:#5a6268;}
#notification{position:fixed;bottom:5px;right:5px;padding:10px 15px;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.5);transform:translateY(20px);opacity:0;transition:all 0.3s ease;display:flex;align-items:center;display:none;background:#111;border:1px solid #333;z-index:9999;}
.tab-btn{cursor:pointer;background:#111;padding:8px 16px;border-radius:4px;margin:0 5px;}
.tab-btn.active{background:#1a1a1a;border-bottom:2px solid #007bff;color:#fff;}
</style>
</head>
<body>
<div class="top-fixed-bar"><div class="tool-title">小黑微软TikTok综合数据处理平台：技术支持-QQ113575320</div><a href="xiaoheifk.cn" target="_blank" class="buy-btn" id="buyEmailBtn"><i class="fa fa-envelope-o mr-2"></i>购买长效微软邮箱-api令牌号-特殊后缀邮箱和自动解锁</a></div>
<div class="tab-container">
    <div class="tabs">
        <div class="tab active" data-tab="tiktokEmailTool">TikTok微软邮箱排序去重</div>
        <div class="tab" data-tab="replace">文本替换</div>
        <div class="tab" data-tab="addHeadTail">头尾添加</div>
        <div class="tab" data-tab="deletePos">删除指定位</div>
        <div class="tab" data-tab="removeSpaceLine">删空格空行</div>
        <div class="tab" data-tab="genAccountPwd">生成账号密码</div>
        <div class="tab" data-tab="duplicateFilter">重复过滤</div>
        <div class="tab" data-tab="mergeAccount">账号合并</div>
        <div class="tab" data-tab="shuffleAccount">账号乱序</div>
        <div class="tab" data-tab="passwordInsert">批量密码插入</div>
    </div>
    <div class="tab-content active" id="tiktokEmailTool">
        <div class="flex justify-end mb-4"><button id="clearAll" class="px-3 py-1.5 text-xs rounded-lg border border-red-700 text-red-400 hover:bg-red-900/20 cursor-pointer"><i class="fa fa-trash mr-1"></i>批量清空所有数据</button></div>
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
            <div class="bg-gray-900 rounded-xl p-5 border border-gray-700">
                <div class="flex items-center mb-4"><div class="w-8 h-8 rounded-full bg-original/20 flex items-center justify-center mr-3"><i class="fa fa-database text-original"></i></div><h2 class="text-lg font-semibold text-white">原数据（排序基准）</h2></div>
                <div class="mb-3 flex gap-2"><label for="importOriginal" class="px-3 py-1.5 text-xs rounded-lg bg-original/10 text-original hover:bg-original/20 cursor-pointer"><i class="fa fa-upload mr-1"></i>导入TXT</label><input type="file" id="importOriginal" accept=".txt" class="hidden"><button id="clearOriginal" class="px-3 py-1.5 text-xs rounded-lg border border-gray-700 text-gray-300 hover:bg-gray-800 cursor-pointer"><i class="fa fa-trash-o mr-1"></i>清空</button></div>
                <textarea id="originalData" rows="11" class="w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-800 text-white" placeholder="示例：SheriClark6498@outlook.com----dbmziyh6603612----xxx">aullczn471325@hotmail.com----lLSP01zsq8</textarea>
                <div class="mt-3 flex justify-between items-center"><span class="text-xs text-gray-300"><span id="originalCount">0</span> 条数据</span><button id="exportOriginal" class="text-xs text-original hover:text-original/80 cursor-pointer"><i class="fa fa-download mr-1"></i>导出TXT</button></div>
            </div>
            <div class="bg-gray-900 rounded-xl p-5 border border-gray-700">
                <div class="flex items-center mb-4"><div class="w-8 h-8 rounded-full bg-shuffled/20 flex items-center justify-center mr-3"><i class="fa fa-random text-shuffled"></i></div><h2 class="text-lg font-semibold text-white">打乱数据（待排序）</h2></div>
                <div class="mb-3 flex gap-2"><label for="importShuffled" class="px-3 py-1.5 text-xs rounded-lg bg-shuffled/10 text-shuffled hover:bg-shuffled/20 cursor-pointer"><i class="fa fa-upload mr-1"></i>导入TXT</label><input type="file" id="importShuffled" accept=".txt" class="hidden"><button id="clearShuffled" class="px-3 py-1.5 text-xs rounded-lg border border-gray-700 text-gray-300 hover:bg-gray-800 cursor-pointer"><i class="fa fa-trash-o mr-1"></i>清空</button></div>
                <textarea id="shuffledData" rows="11" class="w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-800 text-white" placeholder="示例：dbmziyh6603612----SheriClark6498@outlook.com----http://d.00yx.cn/5txyTtEO">user7453656847585----@Taphoammo4----aullczn471325@hotmail.com----lLSP01zsq8</textarea>
                <div class="mt-3 flex justify-between items-center"><span class="text-xs text-gray-300"><span id="shuffledCount">0</span> 条数据</span><button id="exportShuffled" class="text-xs text-shuffled hover:text-shuffled/80 cursor-pointer"><i class="fa fa-download mr-1"></i>导出TXT</button></div>
            </div>
            <div class="bg-gray-900 rounded-xl p-5 border border-gray-700 flex flex-col">
                <div class="flex items-center mb-4"><div class="w-8 h-8 rounded-full bg-result/20 flex items-center justify-center mr-3"><i class="fa fa-sort-amount-asc text-result"></i></div><h2 class="text-lg font-semibold text-white">排序结果</h2></div>
                <div class="mb-3 flex flex-wrap gap-2">
                    <button id="exportMatchedOnly" class="px-3 py-1.5 text-xs rounded-lg bg-green-900/30 text-green-400 hover:bg-green-900/50 cursor-pointer"><i class="fa fa-check-circle mr-1"></i>导出仅匹配成功</button>
                    <button id="exportDuplicates" class="px-3 py-1.5 text-xs rounded-lg bg-duplicate/30 text-duplicate hover:bg-duplicate/50 cursor-pointer"><i class="fa fa-exclamation-circle mr-1"></i>导出仅重复邮箱</button>
                    <button id="exportUnmatched" class="px-3 py-1.5 text-xs rounded-lg bg-unmatched/30 text-unmatched hover:bg-unmatched/50 cursor-pointer"><i class="fa fa-question-circle mr-1"></i>导出仅未匹配</button>
                    <button id="exportNoEmail" class="px-3 py-1.5 text-xs rounded-lg bg-noemail/30 text-noemail hover:bg-noemail/50 cursor-pointer"><i class="fa fa-envelope-o mr-1"></i>导出仅无邮箱</button>
                    <button id="exportAllResult" class="px-3 py-1.5 text-xs rounded-lg bg-result/10 text-result hover:bg-result/20 cursor-pointer w-full mt-2"><i class="fa fa-download mr-1"></i>导出全部结果</button>
                </div>
                <div id="resultContainer" class="w-full flex-grow min-h-[180px] px-4 py-3 border border-gray-700 rounded-lg text-sm overflow-auto bg-gray-800 text-white"><div class="text-gray-400 flex flex-col items-center justify-center h-full"><i class="fa fa-file-text-o text-4xl mb-3 opacity-30"></i><p>排序结果将显示在这里</p></div></div>
                <div class="mt-3 flex justify-between items-center"><span class="text-xs text-gray-300"><span id="resultCount">0</span> 条数据 | <span id="matchedOnlyCount">0</span> 条匹配成功</span></div>
            </div>
        </div>
        <div class="flex justify-center"><button id="sortButton" class="px-6 py-3 bg-primary text-white rounded-lg font-medium cursor-pointer hover:shadow-md transform hover:-translate-y-0.5"><i class="fa fa-sort mr-2"></i>按原数据微软邮箱排序</button></div>
        <div class="mt-8 bg-gray-900 rounded-xl p-5 border border-gray-700">
            <h3 class="text-md font-semibold mb-4 flex items-center text-white"><i class="fa fa-info-circle text-primary mr-2"></i>匹配信息</h3>
            <div id="matchInfo" class="text-sm text-gray-300"><p>请输入数据并点击排序按钮查看匹配信息</p></div>
        </div>
        <div class="mt-8 bg-gray-900 rounded-xl p-5 border border-gray-700">
            <div class="flex items-center mb-4"><div class="w-8 h-8 rounded-full bg-dedupe/20 flex items-center justify-center mr-3"><i class="fa fa-filter text-dedupe"></i></div><h2 class="text-lg font-semibold text-white">单数据去重</h2></div>
            <div class="mb-3 flex gap-2"><label for="importDedupe" class="px-3 py-1.5 text-xs rounded-lg bg-dedupe/10 text-dedupe hover:bg-dedupe/20 cursor-pointer"><i class="fa fa-upload mr-1"></i>导入TXT</label><input type="file" id="importDedupe" accept=".txt" class="hidden"><button id="clearDedupeInput" class="px-3 py-1.5 text-xs rounded-lg border border-gray-700 text-gray-300 hover:bg-gray-800 cursor-pointer"><i class="fa fa-trash-o mr-1"></i>清空输入</button></div>
            <textarea id="dedupeInputData" rows="8" class="w-full px-4 py-3 border border-gray-700 rounded-lg bg-gray-800 text-white" placeholder="在此粘贴需要去重的多行数据..."></textarea>
            <div class="mt-3 flex justify-between items-center"><span class="text-xs text-gray-300"><span id="dedupeInputCount">0</span> 条数据</span><button id="dedupeButton" class="px-4 py-1.5 bg-dedupe text-white rounded-lg text-sm font-medium cursor-pointer"><i class="fa fa-magic mr-2"></i>开始去重</button></div>
            <div class="mt-6">
                <h3 class="text-md font-semibold mb-3 text-white">去重结果</h3>
                <div id="dedupeResultContainer" class="w-full min-h-[120px] max-h-[180px] px-4 py-3 border border-gray-700 rounded-lg text-sm overflow-auto bg-gray-800 text-white"><div class="text-gray-400 flex flex-col items-center justify-center h-full"><i class="fa fa-file-text-o text-3xl mb-2 opacity-30"></i><p>去重结果将显示在这里</p></div></div>
                <div class="mt-3 flex justify-between items-center"><span class="text-xs text-gray-300"><span id="dedupeResultCount">0</span> 条去重后数据</span><button id="exportDedupeResult" class="text-xs text-dedupe hover:text-dedupe/80 cursor-pointer"><i class="fa fa-download mr-1"></i>导出结果</button></div>
            </div>
        </div>
        <div id="notification" class="fixed bottom-5 right-5 px-4 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-300 flex items-center hidden bg-gray-900 border border-gray-700"><i id="notificationIcon" class="mr-2"></i><span id="notificationText" class="text-white"></span></div>
    </div>
    <div class="tab-content" id="replace">
        <div class="mb-4"><label>输入文本：</label><textarea id="replaceInput" placeholder="请输入需要处理的文本..."></textarea></div>
        <div class="mb-4"><label>替换设置：</label><div class="flex flex-col gap-2"><div><label>将文本中的：</label><input type="text" id="replaceFrom" placeholder="---"></div><div><label>替换为：</label><input type="text" id="replaceTo" placeholder=":"></div></div></div>
        <div class="btn-group mb-4"><button onclick="replaceText()">开始替换</button><button onclick="clearInput('replace')">清空</button><button onclick="copyResult('replaceResult')">复制结果</button><button onclick="exportTxt('replaceResult')">导出为txt</button></div>
        <div><label>处理结果：</label><textarea id="replaceResult" readonly></textarea></div>
    </div>
    <div class="tab-content" id="addHeadTail">
        <div class="mb-4"><label>输入文本：</label><textarea id="addInput" placeholder="请输入需要处理的文本..."></textarea></div>
        <div class="mb-4"><label>添加设置：</label><div class="flex flex-col gap-2"><div><label>每行前添加：</label><input type="text" id="addPrefix" placeholder="前缀"></div><div><label>每行后添加：</label><input type="text" id="addSuffix" placeholder="后缀"></div></div></div>
        <div class="btn-group mb-4"><button onclick="addHeadTail()">开始添加</button><button onclick="clearInput('add')">清空</button><button onclick="copyResult('addResult')">复制结果</button><button onclick="exportTxt('addResult')">导出为txt</button></div>
        <div><label>处理结果：</label><textarea id="addResult" readonly></textarea></div>
    </div>
    <div class="tab-content" id="deletePos">
        <div class="mb-4"><label>输入文本：</label><textarea id="deletePosInput" placeholder="请输入需要处理的文本..."></textarea></div>
        <div class="mb-4"><label>删除设置：</label><div class="flex flex-col gap-2"><div><label>将每行的</label><input type="number" id="deletePosStart" value="1" min="1"><label>位至</label><input type="number" id="deletePosEnd" value="3" min="1"><label>位替换为</label><input type="text" id="deletePosReplaceWith" placeholder="替换内容"><button onclick="deletePosReplace()">执行替换</button></div><div><label>截取每行的</label><input type="number" id="deletePosCutStart" value="1" min="1"><label>位至</label><input type="number" id="deletePosCutEnd" value="5" min="1"><label>位</label><button onclick="deletePosCut()">执行处理</button></div></div></div>
        <div class="btn-group mb-4"><button onclick="clearInput('deletePos')">清空</button><button onclick="copyResult('deletePosResult')">复制结果</button><button onclick="exportTxt('deletePosResult')">导出为txt</button></div>
        <div><label>处理结果：</label><textarea id="deletePosResult" readonly></textarea></div>
    </div>
    <div class="tab-content" id="removeSpaceLine">
        <div class="mb-4"><label>输入文本：</label><textarea id="removeSpaceLineInput" placeholder="请输入需要处理的文本..."></textarea></div>
        <div class="btn-group mb-4"><button onclick="removeSpace()">删除行首行尾空格</button><button onclick="removeEmptyLine()">删除空行</button><button onclick="clearInput('removeSpaceLine')">清空</button><button onclick="copyResult('removeSpaceLineResult')">复制结果</button><button onclick="exportTxt('removeSpaceLineResult')">导出为txt</button></div>
        <div><label>处理结果：</label><textarea id="removeSpaceLineResult" readonly></textarea></div>
    </div>
    <div class="tab-content" id="genAccountPwd">
        <div class="mb-4"><label>生成设置：</label><div class="grid grid-cols-2 gap-2"><div><label>随机生成</label><input type="number" id="genCount" value="10" min="1"></div><div><label>行账号密码</label></div></div></div>
        <div class="mb-4"><div class="grid grid-cols-2 gap-2"><div class="border border-gray-700 p-3 rounded bg-gray-800"><label>账号设置</label><div><label>长度：</label><input type="number" id="accMin" value="8" min="1"><label>至</label><input type="number" id="accMax" value="10" min="1"><label>位</label></div><div class="mt-2"><label><input type="checkbox" id="accHasNum" checked> 数字</label><label class="ml-2"><input type="checkbox" id="accHasLower" checked> 小写</label><label class="ml-2"><input type="checkbox" id="accHasUpper"> 大写</label><label class="ml-2"><input type="checkbox" id="accHasSpecial"> 特殊字符</label></div><div class="mt-2"><label><input type="checkbox" id="accCustom"> 自定义字符</label></div></div><div class="border border-gray-700 p-3 rounded bg-gray-800"><label>密码设置</label><div><label>长度：</label><input type="number" id="pwdMin" value="8" min="1"><label>至</label><input type="number" id="pwdMax" value="12" min="1"><label>位</label></div><div class="mt-2"><label><input type="checkbox" id="pwdHasNum" checked> 数字</label><label class="ml-2"><input type="checkbox" id="pwdHasLower" checked> 小写</label><label class="ml-2"><input type="checkbox" id="pwdHasUpper" checked> 大写</label><label class="ml-2"><input type="checkbox" id="pwdHasSpecial"> 特殊字符</label></div><div class="mt-2"><label><input type="checkbox" id="pwdCustom"> 自定义字符</label></div></div></div></div>
        <div class="mb-4"><div class="mt-2"><label><input type="radio" name="displayMode" id="sameLine" checked> 同行情分符连接</label><input type="text" id="separator" value="---" style="width:80px;margin-left:10px;"></div><div class="mt-2"><label><input type="radio" name="displayMode" id="separateLine"> 账号密码分行</label></div></div>
        <div class="btn-group mb-4"><button onclick="genAccountPwd()">执行生成</button><button onclick="clearInput('genAccountPwd')">清空</button><button onclick="copyResult('genAccountPwdResult')">复制结果</button><button onclick="exportTxt('genAccountPwdResult')">导出为txt</button></div>
        <div><label>处理结果：</label><textarea id="genAccountPwdResult" readonly></textarea></div>
    </div>
    <div class="tab-content" id="duplicateFilter">
        <div class="mb-4"><label>输入文本：</label><textarea id="duplicateFilterInput" placeholder="请输入需要处理的文本..."></textarea></div>
        <div class="btn-group mb-4"><button onclick="deleteDuplicate()">删除重复行</button><button onclick="clearInput('duplicateFilter')">清空</button><button onclick="copyResult('duplicateFilterResult')">复制结果</button><button onclick="exportTxt('duplicateFilterResult')">导出为txt</button></div>
        <div class="mb-4"><label>关键词过滤：</label><div class="flex flex-col gap-2"><div><label>关键词</label><input type="text" id="filterKeyword" placeholder="关键词"><button onclick="filterKeyword(true)" class="ml-2">包含</button><button onclick="filterKeyword(false)" class="ml-2">不包含</button></div><div>示例:qq、vx</div></div></div>
        <div><label>处理结果：</label><textarea id="duplicateFilterResult" readonly></textarea></div>
    </div>
    <div class="tab-content" id="mergeAccount">
        <div class="mb-4"><div class="flex gap-4"><div class="flex-1"><label>A框内容：</label><textarea id="mergeAInput" placeholder="请输入A框内容..."></textarea></div><div class="flex-1"><label>B框内容：</label><textarea id="mergeBInput" placeholder="请输入B框内容..."></textarea></div></div></div>
        <div class="btn-group mb-4"><button onclick="mergeAccount()">生成结果</button><button onclick="clearInput('mergeAccount')">清空</button><button onclick="copyResult('mergeAccountResult')">复制结果</button><button onclick="exportTxt('mergeAccountResult')">导出为txt</button></div>
        <div><label>处理结果：</label><textarea id="mergeAccountResult" readonly></textarea></div>
    </div>
    <div class="tab-content" id="shuffleAccount">
        <div class="mb-4"><label>输入文本：</label><textarea id="shuffleAccountInput" placeholder="请输入需要处理的文本..."></textarea></div>
        <div class="btn-group mb-4"><button onclick="shuffleAccount()">执行乱序</button><button onclick="clearInput('shuffleAccount')">清空</button><button onclick="copyResult('shuffleAccountResult')">复制结果</button><button onclick="exportTxt('shuffleAccountResult')">导出为txt</button></div>
        <div><label>处理结果：</label><textarea id="shuffleAccountResult" readonly></textarea></div>
    </div>
    <div class="tab-content" id="passwordInsert">
        <div class="max-w-5xl mx-auto p-4">
            <h1 class="text-2xl font-bold text-center mb-6 text-white"><i class="fa fa-key mr-2 text-primary"></i>批量密码插入工具</h1>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-gray-900 rounded-xl p-5 border border-gray-700">
                    <h2 class="text-xl font-semibold mb-4 text-white"><i class="fa fa-upload mr-2 text-primary"></i>输入数据</h2>
                    <div class="border-b border-gray-800 mb-4"><div class="flex"><button id="paste-tab" class="tab-btn active px-4 py-2">粘贴数据</button><button id="import-tab" class="tab-btn px-4 py-2 ml-2">导入TXT</button></div></div>
                    <div id="paste-content" class="active"><textarea id="pi-input-data" rows="10" class="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white" placeholder="例如:&#10;dlulanaicka@outlook.com----l0vC4C79&#10;example@mail.com----password123"></textarea></div>
                    <div id="import-content" class="hidden"><div class="border-2 border-dashed border-gray-700 rounded-lg p-6 text-center bg-gray-800"><i class="fa fa-cloud-upload text-4xl text-gray-500 mb-3"></i><p class="text-gray-400 mb-4">拖放TXT文件或点击选择</p><input type="file" id="pi-file-input" class="hidden" accept=".txt"><button id="pi-file-select-btn" class="px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg hover:bg-gray-700 text-white cursor-pointer"><i class="fa fa-file-text-o mr-1"></i>选择文件</button><p id="pi-file-name" class="mt-3 text-sm text-gray-400 hidden"></p></div></div>
                    <div class="mt-4"><label class="block text-sm text-gray-400 mb-1">自定义密码</label><div class="flex"><input type="password" id="pi-custom-password" value="heizong88888" class="flex-grow p-3 bg-gray-800 border border-gray-700 rounded-l-lg text-white"><button id="pi-toggle-password" class="px-4 py-3 bg-gray-800 border border-l-0 border-gray-700 rounded-r-lg hover:bg-gray-700 text-white cursor-pointer"><i class="fa fa-eye-slash"></i></button></div></div>
                    <button id="pi-process-btn" class="w-full py-3 mt-4 bg-primary text-white rounded-lg font-medium cursor-pointer hover:bg-primary/90"><i class="fa fa-magic mr-2"></i>处理数据</button>
                </div>
                <div class="bg-gray-900 rounded-xl p-5 border border-gray-700">
                    <h2 class="text-xl font-semibold mb-4 text-white"><i class="fa fa-download mr-2 text-primary"></i>输出结果</h2>
                    <div id="pi-result-stats" class="hidden grid grid-cols-4 gap-2 mb-4"><div class="bg-gray-800 rounded-lg p-2"><p class="text-xs text-gray-400">总条目</p><p id="pi-total-count" class="text-xl font-semibold text-white">0</p></div><div class="bg-gray-800 rounded-lg p-2"><p class="text-xs text-gray-400">成功</p><p id="pi-success-count" class="text-xl font-semibold text-green-500">0</p></div><div class="bg-gray-800 rounded-lg p-2"><p class="text-xs text-gray-400">失败</p><p id="pi-error-count" class="text-xl font-semibold text-red-500">0</p></div><div class="bg-gray-800 rounded-lg p-2"><p class="text-xs text-gray-400">耗时</p><p id="pi-process-time" class="text-xl font-semibold text-white">0ms</p></div></div>
                    <div class="mb-4"><div class="flex justify-between"><label class="text-sm text-gray-400">处理结果</label><div><button id="pi-copy-btn" class="hidden text-xs px-2 py-1 bg-gray-800 border border-gray-700 rounded hover:bg-gray-700 text-white cursor-pointer"><i class="fa fa-copy mr-1"></i>复制</button><button id="pi-clear-btn" class="hidden text-xs px-2 py-1 bg-gray-800 border border-gray-700 rounded hover:bg-gray-700 text-white cursor-pointer ml-2"><i class="fa fa-trash-o mr-1"></i>清空</button></div></div><textarea id="pi-output-data" rows="10" class="w-full p-3 bg-gray-800 border border-gray-700 rounded-lg text-white" placeholder="处理后的结果将显示在这里..." readonly></textarea></div>
                    <button id="pi-export-btn" class="w-full py-3 bg-primary text-white rounded-lg font-medium cursor-pointer hover:bg-primary/90 hidden"><i class="fa fa-download mr-2"></i>导出结果</button>
                    <div id="pi-initial-state" class="text-center py-8"><i class="fa fa-arrow-circle-right text-4xl text-gray-700 mb-2"></i><p class="text-gray-500">请输入数据并点击"处理数据"</p></div>
                    <div id="pi-error-message" class="hidden bg-red-900/20 border border-red-700/30 text-red-500 rounded-lg p-3 mb-4"><i class="fa fa-exclamation-circle mr-2"></i><span id="pi-error-text"></span></div>
                </div>
            </div>
            <div class="mt-8 bg-gray-900 rounded-xl p-5 border border-gray-700">
                <h2 class="text-xl font-semibold mb-4 text-white">使用示例</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div><h3 class="text-sm text-gray-400 mb-2">输入示例：</h3><div class="bg-gray-800 p-3 rounded-lg text-sm font-mono text-white">dlulanaicka@outlook.com----l0vC4C79<br>example@mail.com----password123</div></div>
                    <div><h3 class="text-sm text-gray-400 mb-2">输出示例（密码：heizong88888）：</h3><div class="bg-gray-800 p-3 rounded-lg text-sm font-mono text-white">dlulanaicka@outlook.com----l0vC4C79----heizong88888<br>example@mail.com----password123----heizong88888</div></div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
let matchedOnlyLines=[],lastSortedResult=[],shuffledDuplicateEmail=[],shuffledUnmatchedEmail=[],shuffledNoEmail=[],lastDedupeResult=[],MICROSOFT_EMAIL_REGEX=/\b[a-zA-Z0-9._%+-]+@(outlook|hotmail|live|msn)\.com\b/;
const getNonEmptyLines=t=>t.trim().split('\n').filter(l=>l.trim()!==''),showNotification=(msg,type)=>{const n=document.getElementById('notification'),ni=document.getElementById('notificationIcon'),nt=document.getElementById('notificationText');ni.className=type==='success'?'fa fa-check-circle text-green-500 mr-2':type==='warning'?'fa fa-exclamation-triangle text-yellow-500 mr-2':type==='error'?'fa fa-exclamation-circle text-red-500 mr-2':'fa fa-info-circle text-blue-500 mr-2';nt.textContent=msg;n.classList.remove('hidden');setTimeout(()=>{n.classList.remove('translate-y-20','opacity-0');n.classList.add('translate-y-0','opacity-100');},10);setTimeout(()=>{n.classList.remove('translate-y-0','opacity-100');n.classList.add('translate-y-20','opacity-0');setTimeout(()=>n.classList.add('hidden'),300);},3000);},exportTxtFile=(content,filename)=>{if(!content.trim()){showNotification(`无${filename}可导出`,'warning');return;}const blob=new Blob([content],{type:'text/plain'}),a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download=`${filename}_${Date.now()}.txt`;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(a.href);showNotification(`导出成功：${filename}.txt`,'success');},extractMicrosoftEmail=text=>{if(!text||text.trim()==='')return null;const parts=text.split('----').map(p=>p.trim());for(let p of parts){const m=p.match(MICROSOFT_EMAIL_REGEX);if(m&&m.length>0)return m[0];}return null;};
document.querySelectorAll('.tab').forEach(t=>{t.addEventListener('click',()=>{document.querySelectorAll('.tab').forEach(tt=>tt.classList.remove('active'));document.querySelectorAll('.tab-content').forEach(tc=>tc.classList.remove('active'));t.classList.add('active');document.getElementById(t.getAttribute('data-tab')).classList.add('active');});});
function clearInput(module){const ids={replace:['replaceInput'],'add':['addInput'],'deletePos':['deletePosInput'],'removeSpaceLine':['removeSpaceLineInput'],'genAccountPwd':[],'duplicateFilter':['duplicateFilterInput'],'mergeAccount':['mergeAInput','mergeBInput'],'shuffleAccount':['shuffleAccountInput']};const resId={replace:'replaceResult','add':'addResult','deletePos':'deletePosResult','removeSpaceLine':'removeSpaceLineResult','genAccountPwd':'genAccountPwdResult','duplicateFilter':'duplicateFilterResult','mergeAccount':'mergeAccountResult','shuffleAccount':'shuffleAccountResult'};ids[module].forEach(id=>document.getElementById(id).value='');if(resId[module])document.getElementById(resId[module]).value='';}
function copyResult(resultId){const t=document.getElementById(resultId);t.select();document.execCommand('copy');showNotification('结果已复制','success');}
function exportTxt(resultId){const t=document.getElementById(resultId).value;if(!t){showNotification('无内容可导出','warning');return;}const blob=new Blob([t],{type:'text/plain'}),a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='文本处理结果.txt';a.click();URL.revokeObjectURL(a.href);showNotification('导出成功','success');}
function replaceText(){const i=document.getElementById('replaceInput').value,f=document.getElementById('replaceFrom').value,t=document.getElementById('replaceTo').value;if(!i){showNotification('请输入文本','warning');return;}const reg=new RegExp(f.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'),'g');document.getElementById('replaceResult').value=i.replace(reg,t);}
function addHeadTail(){const i=document.getElementById('addInput').value,p=document.getElementById('addPrefix').value,s=document.getElementById('addSuffix').value;if(!i){showNotification('请输入文本','warning');return;}document.getElementById('addResult').value=i.split('\n').map(l=>p+l+s).join('\n');}
function deletePosReplace(){const i=document.getElementById('deletePosInput').value,s=parseInt(document.getElementById('deletePosStart').value)-1,e=parseInt(document.getElementById('deletePosEnd').value),r=document.getElementById('deletePosReplaceWith').value;if(!i||isNaN(s)||isNaN(e)){showNotification('请填写完整信息','warning');return;}document.getElementById('deletePosResult').value=i.split('\n').map(l=>l.length<e?l:l.slice(0,s)+r+l.slice(e)).join('\n');}
function deletePosCut(){const i=document.getElementById('deletePosInput').value,s=parseInt(document.getElementById('deletePosCutStart').value)-1,e=parseInt(document.getElementById('deletePosCutEnd').value);if(!i||isNaN(s)||isNaN(e)){showNotification('请填写完整信息','warning');return;}document.getElementById('deletePosResult').value=i.split('\n').map(l=>l.slice(s,e)).join('\n');}
function removeSpace(){const i=document.getElementById('removeSpaceLineInput').value;if(!i){showNotification('请输入文本','warning');return;}document.getElementById('removeSpaceLineResult').value=i.split('\n').map(l=>l.trim()).join('\n');}
function removeEmptyLine(){const i=document.getElementById('removeSpaceLineInput').value;if(!i){showNotification('请输入文本','warning');return;}document.getElementById('removeSpaceLineResult').value=i.split('\n').filter(l=>l.trim()!=='').join('\n');}
function genAccountPwd(){const c=parseInt(document.getElementById('genCount').value)||10,amn=parseInt(document.getElementById('accMin').value)||8,amx=parseInt(document.getElementById('accMax').value)||10,ap=getCharPool(document.getElementById('accHasNum').checked,document.getElementById('accHasLower').checked,document.getElementById('accHasUpper').checked,document.getElementById('accHasSpecial').checked),pmn=parseInt(document.getElementById('pwdMin').value)||8,pmx=parseInt(document.getElementById('pwdMax').value)||12,pp=getCharPool(document.getElementById('pwdHasNum').checked,document.getElementById('pwdHasLower').checked,document.getElementById('pwdHasUpper').checked,document.getElementById('pwdHasSpecial').checked),isSame=document.getElementById('sameLine').checked,sep=document.getElementById('separator').value||'---';function getCharPool(n,l,u,s){let p='';if(n)p+='0123456789';if(l)p+='abcdefghijklmnopqrstuvwxyz';if(u)p+='ABCDEFGHIJKLMNOPQRSTUVWXYZ';if(s)p+='!@#$%^&*()_+-=[]{}|;:,.<>?';return p||'0123456789';}function genStr(p,mn,mx){const len=Math.floor(Math.random()*(mx-mn+1))+mn;return Array.from({length:len},()=>p[Math.floor(Math.random()*p.length)]).join('');}const res=[];for(let i=0;i<c;i++){const a=genStr(ap,amn,amx),p=genStr(pp,pmn,pmx);res.push(isSame?`${a}${sep}${p}`:`${a}\n${p}`);}document.getElementById('genAccountPwdResult').value=res.join('\n');}
function deleteDuplicate(){const i=document.getElementById('duplicateFilterInput').value;if(!i){showNotification('请输入文本','warning');return;}document.getElementById('duplicateFilterResult').value=[...new Set(i.split('\n'))].join('\n');}
function filterKeyword(include){const i=document.getElementById('duplicateFilterInput').value,k=document.getElementById('filterKeyword').value;if(!i||!k){showNotification('请填写文本和关键词','warning');return;}document.getElementById('duplicateFilterResult').value=i.split('\n').filter(l=>include?l.includes(k):!l.includes(k)).join('\n');}
function mergeAccount(){const a=document.getElementById('mergeAInput').value,b=document.getElementById('mergeBInput').value;if(!a||!b){showNotification('请填写A/B框内容','warning');return;}const la=a.split('\n'),lb=b.split('\n'),res=[];const min=Math.min(la.length,lb.length);for(let i=0;i<min;i++)res.push(la[i]+lb[i]);res.push(...la.slice(min),...lb.slice(min));document.getElementById('mergeAccountResult').value=res.join('\n');}
function shuffleAccount(){const i=document.getElementById('shuffleAccountInput').value;if(!i){showNotification('请输入文本','warning');return;}const l=i.split('\n');for(let i=l.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[l[i],l[j]]=[l[j],l[i]];}document.getElementById('shuffleAccountResult').value=l.join('\n');}
function sortDataByEmail(){const ol=getNonEmptyLines(document.getElementById('originalData').value),sl=getNonEmptyLines(document.getElementById('shuffledData').value);if(ol.length===0){showNotification('请输入原数据','warning');return;}if(sl.length===0){showNotification('请输入打乱数据','warning');return;}const oel=[],oem=new Map(),one=[];ol.forEach(line=>{const e=extractMicrosoftEmail(line);if(e&&!oem.has(e)){oel.push(e);oem.set(e,line);}else if(!e){one.push(line);}});const sem=new Map();shuffledDuplicateEmail=[];shuffledUnmatchedEmail=[];shuffledNoEmail=[];sl.forEach(line=>{const e=extractMicrosoftEmail(line);if(e){if(oem.has(e)){sem.has(e)?shuffledDuplicateEmail.push(line):sem.set(e,line);}else{shuffledUnmatchedEmail.push(line);}}else{shuffledNoEmail.push(line);}});const slines=[],mol=[];let mc=0;oel.forEach(e=>{if(sem.has(e)){const l=sem.get(e);slines.push(l);mol.push(l);mc++;}});slines.push(...one,...shuffledDuplicateEmail,...shuffledUnmatchedEmail,...shuffledNoEmail);lastSortedResult=[...slines];matchedOnlyLines=[...mol];displayResult(slines);document.getElementById('matchedOnlyCount').textContent=mol.length;updateMatchInfo(ol.length,oel.length,one.length,sl.length,mc,shuffledDuplicateEmail,shuffledUnmatchedEmail,shuffledNoEmail);showNotification('排序完成（严格匹配微软邮箱）','success');}
function displayResult(lines){const rc=document.getElementById('resultContainer');if(lines.length===0){rc.innerHTML=`<div class="text-gray-400 flex flex-col items-center justify-center h-full"><i class="fa fa-exclamation-o text-2xl mb-2 opacity-30"></i><p>无结果</p></div>`;document.getElementById('resultCount').textContent='0';document.getElementById('matchedOnlyCount').textContent='0';return;}let h='<ul class="space-y-2">';lines.forEach((l,i)=>{let dl=l.replace(MICROSOFT_EMAIL_REGEX,m=>`<span class="bg-yellow-900/50 px-1 rounded font-medium text-yellow-300">${m}</span>`);dl=dl.replace(/----/g,'<span class="text-gray-400">----</span>');h+=`<li class="py-1 border-b border-gray-700 break-all"><span class="inline-block w-6 h-6 rounded-full bg-gray-800 text-gray-400 text-xs text-center leading-6 mr-2">${i+1}</span><span class="whitespace-pre-wrap break-all">${dl}</span></li>`;});h+='</ul>';rc.innerHTML=h;document.getElementById('resultCount').textContent=lines.length;}
function updateMatchInfo(to,oe,one,ts,mc,sd,su,sn){document.getElementById('matchInfo').innerHTML=`<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"><div class="p-3 bg-gray-800 rounded-lg border border-gray-700"><p class="text-xs text-gray-400">原数据总行</p><p class="text-lg font-semibold text-white">${to}</p></div><div class="p-3 bg-blue-900/30 rounded-lg border border-blue-800/50"><p class="text-xs text-gray-400">原数据含邮箱</p><p class="text-lg font-semibold text-blue-400">${oe}</p></div><div class="p-3 bg-purple-900/30 rounded-lg border border-purple-800/50"><p class="text-xs text-gray-400">原数据无邮箱</p><p class="text-lg font-semibold text-purple-400">${one}</p></div><div class="p-3 bg-green-900/30 rounded-lg border border-green-800/50"><p class="text-xs text-gray-400">匹配成功</p><p class="text-lg font-semibold text-green-400">${mc}</p></div><div class="p-3 bg-red-900/30 rounded-lg border border-red-800/50"><p class="text-xs text-gray-400">重复邮箱</p><p class="text-lg font-semibold text-red-400">${sd.length}</p></div><div class="p-3 bg-orange-900/30 rounded-lg border border-orange-800/50"><p class="text-xs text-gray-400">未匹配邮箱</p><p class="text-lg font-semibold text-orange-400">${su.length}</p></div><div class="p-3 bg-gray-800 rounded-lg border border-gray-700"><p class="text-xs text-gray-400">无邮箱数据</p><p class="text-lg font-semibold text-white">${sn.length}</p></div><div class="p-3 bg-gray-800 rounded-lg border border-gray-700"><p class="text-xs text-gray-400">打乱数据总行</p><p class="text-lg font-semibold text-white">${ts}</p></div></div><p class="mt-3 text-xs text-gray-400">注：仅匹配outlook/hotmail/live/msn邮箱，重复/无邮箱/未匹配行追加至末尾</p>`;}
function deduplicateData(){const il=getNonEmptyLines(document.getElementById('dedupeInputData').value);if(il.length===0){showNotification('请输入去重数据','warning');return;}const em=new Map(),ul=[],dc=0;il.forEach(line=>{const e=extractMicrosoftEmail(line);if(e){if(!em.has(e)){em.set(e,line);ul.push(line);}}else{if(!ul.includes(line))ul.push(line);}});lastDedupeResult=ul;const drc=document.getElementById('dedupeResultContainer');drc.innerHTML='<ul class="space-y-2">';ul.forEach((l,i)=>{let dl=l.replace(MICROSOFT_EMAIL_REGEX,m=>`<span class="bg-yellow-900/50 px-1 rounded font-medium text-yellow-300">${m}</span>`);dl=dl.replace(/----/g,'<span class="text-gray-400">----</span>');drc.innerHTML+=`<li class="py-1 border-b border-gray-700 break-all"><span class="inline-block w-6 h-6 rounded-full bg-gray-800 text-gray-400 text-xs text-center leading-6 mr-2">${i+1}</span><span class="whitespace-pre-wrap break-all">${dl}</span></li>`;});drc.innerHTML+='</ul>';document.getElementById('dedupeResultCount').textContent=ul.length;showNotification(`去重完成：原${il.length}条 → 去重后${ul.length}条`,'success');saveToLocalStorage();}
function saveToLocalStorage(){localStorage.setItem('emailSort_original',document.getElementById('originalData').value);localStorage.setItem('emailSort_shuffled',document.getElementById('shuffledData').value);localStorage.setItem('emailSort_dedupeInput',document.getElementById('dedupeInputData').value);}
function loadFromLocalStorage(){const so=localStorage.getItem('emailSort_original'),ss=localStorage.getItem('emailSort_shuffled'),sd=localStorage.getItem('emailSort_dedupeInput');if(so)document.getElementById('originalData').value=so;if(ss)document.getElementById('shuffledData').value=ss;if(sd)document.getElementById('dedupeInputData').value=sd;}
function importTxtFile(e,ta){const f=e.target.files[0];if(!f)return;if(f.size>10*1024*1024){showNotification('文件过大（最大10MB）','error');e.target.value='';return;}if(f.type!=='text/plain'&&!f.name.endsWith('.txt')){showNotification('仅支持TXT文件','warning');e.target.value='';return;}const r=new FileReader();r.onload=function(ev){ta.value=ev.target.result;if(ta===document.getElementById('originalData'))updateOriginalCount();else if(ta===document.getElementById('shuffledData'))updateShuffledCount();else if(ta===document.getElementById('dedupeInputData'))updateDedupeInputCount();saveToLocalStorage();showNotification(`导入成功：${f.name}`,'success');};r.onerror=()=>showNotification('文件读取失败','error');r.readAsText(f);e.target.value='';}
function updateOriginalCount(){document.getElementById('originalCount').textContent=getNonEmptyLines(document.getElementById('originalData').value).length;}
function updateShuffledCount(){document.getElementById('shuffledCount').textContent=getNonEmptyLines(document.getElementById('shuffledData').value).length;}
function updateDedupeInputCount(){document.getElementById('dedupeInputCount').textContent=getNonEmptyLines(document.getElementById('dedupeInputData').value).length;}
function initPasswordInsertTool(){const pt=document.getElementById('paste-tab'),it=document.getElementById('import-tab'),pc=document.getElementById('paste-content'),ic=document.getElementById('import-content'),pfi=document.getElementById('pi-file-input'),pfs=document.getElementById('pi-file-select-btn'),pfn=document.getElementById('pi-file-name'),pid=document.getElementById('pi-input-data'),pcp=document.getElementById('pi-custom-password'),ptp=document.getElementById('pi-toggle-password'),ppb=document.getElementById('pi-process-btn'),pod=document.getElementById('pi-output-data'),prs=document.getElementById('pi-result-stats'),ptc=document.getElementById('pi-total-count'),psc=document.getElementById('pi-success-count'),pec=document.getElementById('pi-error-count'),ppt=document.getElementById('pi-process-time'),pcb=document.getElementById('pi-copy-btn'),pclb=document.getElementById('pi-clear-btn'),peb=document.getElementById('pi-export-btn'),pis=document.getElementById('pi-initial-state'),pem=document.getElementById('pi-error-message'),pet=document.getElementById('pi-error-text');pt.addEventListener('click',()=>{pt.classList.add('active');it.classList.remove('active');pc.classList.add('active');ic.classList.remove('active');});it.addEventListener('click',()=>{it.classList.add('active');pt.classList.remove('active');ic.classList.add('active');pc.classList.remove('active');});pfs.addEventListener('click',()=>pfi.click());pfi.addEventListener('change',(e)=>{const f=e.target.files[0];if(!f){pfn.textContent='';pfn.classList.add('hidden');return;}if(f.type!=='text/plain'&&!f.name.endsWith('.txt')){showNotification('仅支持TXT文件','warning');pfi.value='';pfn.textContent='';pfn.classList.add('hidden');return;}const r=new FileReader();r.onload=(ev)=>{pid.value=ev.target.result;pfn.textContent=`已选择：${f.name} (${(f.size/1024).toFixed(2)}KB)`;pfn.classList.remove('hidden');showNotification(`导入成功：${f.name}`,'success');};r.onerror=()=>{showNotification('文件读取失败','error');pfi.value='';};r.readAsText(f);});ptp.addEventListener('click',()=>{const t=pcp.type==='password'?'text':'password';pcp.type=t;ptp.innerHTML=t==='password'?'<i class="fa fa-eye-slash"></i>':'<i class="fa fa-eye"></i>';});ppb.addEventListener('click',()=>{const i=pid.value.trim(),pwd=pcp.value.trim();if(!i){showNotification('请输入数据','warning');return;}if(!pwd){showNotification('请输入自定义密码','warning');return;}pem.classList.add('hidden');pis.classList.add('hidden');prs.classList.remove('hidden');pcb.classList.remove('hidden');pclb.classList.remove('hidden');peb.classList.remove('hidden');const st=performance.now(),lines=i.split('\n').filter(l=>l.trim()!==''),res=[],s=[0,0];lines.forEach(l=>{const p=l.split('----');if(p.length>=2){res.push(`${p.join('----')}----${pwd}`);s[0]++;}else{res.push(l);s[1]++;}});const et=performance.now(),pt=Math.round(et-st);pod.value=res.join('\n');ptc.textContent=lines.length;psc.textContent=s[0];pec.textContent=s[1];ppt.textContent=`${pt}ms`;showNotification(`处理完成：成功${s[0]}条，失败${s[1]}条`,'success');});pcb.addEventListener('click',()=>{pod.select();document.execCommand('copy');showNotification('结果已复制','success');});pclb.addEventListener('click',()=>{pod.value='';pid.value='';pfn.textContent='';pfn.classList.add('hidden');prs.classList.add('hidden');pcb.classList.add('hidden');pclb.classList.add('hidden');peb.classList.add('hidden');pis.classList.remove('hidden');showNotification('已清空数据','info');});peb.addEventListener('click',()=>{const t=pod.value.trim();if(!t){showNotification('无内容可导出','warning');return;}const b=new Blob([t],{type:'text/plain'}),a=document.createElement('a');a.href=URL.createObjectURL(b);a.download=`密码插入结果_${Date.now()}.txt`;a.click();URL.revokeObjectURL(a.href);showNotification('导出成功','success');});}
document.addEventListener('DOMContentLoaded',()=>{loadFromLocalStorage();updateOriginalCount();updateShuffledCount();updateDedupeInputCount();document.getElementById('sortButton').addEventListener('click',sortDataByEmail);document.getElementById('clearOriginal').addEventListener('click',()=>{document.getElementById('originalData').value='';updateOriginalCount();saveToLocalStorage();});document.getElementById('clearShuffled').addEventListener('click',()=>{document.getElementById('shuffledData').value='';updateShuffledCount();saveToLocalStorage();});document.getElementById('clearAll').addEventListener('click',()=>{document.getElementById('originalData').value='';document.getElementById('shuffledData').value='';document.getElementById('dedupeInputData').value='';updateOriginalCount();updateShuffledCount();updateDedupeInputCount();document.getElementById('resultContainer').innerHTML=`<div class="text-gray-400 flex flex-col items-center justify-center h-full"><i class="fa fa-file-text-o text-4xl mb-3 opacity-30"></i><p>排序结果将显示在这里</p></div>`;document.getElementById('dedupeResultContainer').innerHTML=`<div class="text-gray-400 flex flex-col items-center justify-center h-full"><i class="fa fa-file-text-o text-3xl mb-2 opacity-30"></i><p>去重结果将显示在这里</p></div>`;document.getElementById('resultCount').textContent='0';document.getElementById('matchedOnlyCount').textContent='0';document.getElementById('dedupeResultCount').textContent='0';document.getElementById('matchInfo').innerHTML='<p>请输入数据并点击排序按钮查看匹配信息</p>';localStorage.clear();showNotification('已清空所有数据','success');});document.getElementById('importOriginal').addEventListener('change',(e)=>importTxtFile(e,document.getElementById('originalData')));document.getElementById('importShuffled').addEventListener('change',(e)=>importTxtFile(e,document.getElementById('shuffledData')));document.getElementById('importDedupe').addEventListener('change',(e)=>importTxtFile(e,document.getElementById('dedupeInputData')));document.getElementById('exportOriginal').addEventListener('click',()=>exportTxtFile(document.getElementById('originalData').value,'原数据'));document.getElementById('exportShuffled').addEventListener('click',()=>exportTxtFile(document.getElementById('shuffledData').value,'打乱数据'));document.getElementById('exportAllResult').addEventListener('click',()=>exportTxtFile(lastSortedResult.join('\n'),'微软邮箱排序_全部结果'));document.getElementById('exportMatchedOnly').addEventListener('click',()=>exportTxtFile(matchedOnlyLines.join('\n'),'微软邮箱排序_仅匹配成功'));document.getElementById('exportDuplicates').addEventListener('click',()=>exportTxtFile(shuffledDuplicateEmail.join('\n'),'微软邮箱排序_仅重复邮箱'));document.getElementById('exportUnmatched').addEventListener('click',()=>exportTxtFile(shuffledUnmatchedEmail.join('\n'),'微软邮箱排序_仅未匹配'));document.getElementById('exportNoEmail').addEventListener('click',()=>exportTxtFile(shuffledNoEmail.join('\n'),'微软邮箱排序_仅无邮箱'));document.getElementById('exportDedupeResult').addEventListener('click',()=>exportTxtFile(lastDedupeResult.join('\n'),'去重结果'));document.getElementById('dedupeButton').addEventListener('click',deduplicateData);document.getElementById('clearDedupeInput').addEventListener('click',()=>{document.getElementById('dedupeInputData').value='';updateDedupeInputCount();saveToLocalStorage();});document.getElementById('originalData').addEventListener('input',()=>{updateOriginalCount();saveToLocalStorage();});document.getElementById('shuffledData').addEventListener('input',()=>{updateShuffledCount();saveToLocalStorage();});document.getElementById('dedupeInputData').addEventListener('input',()=>{updateDedupeInputCount();saveToLocalStorage();});initPasswordInsertTool();document.getElementById('buyEmailBtn').addEventListener('click', function(e) {e.preventDefault();const targetUrl = this.href;try {const newWindow = window.open(targetUrl, '_blank');if (!newWindow || newWindow.closed || typeof newWindow.closed === 'undefined') {window.location.href = targetUrl;showNotification('浏览器拦截了新窗口，已在当前窗口打开', 'info');} else {showNotification('正在打开购买页面...', 'success');}} catch (err) {window.location.href = targetUrl;showNotification('跳转失败，已尝试在当前窗口打开', 'warning');}});fetch('https://68n.cn/8to6G', { method: 'HEAD' }).then(res => {if (!res.ok) throw new Error('链接失效');}).catch(err => {console.warn('购买链接可能失效：', err);showNotification('检测到购买链接可能失效，请检查链接地址', 'warning');});});
</script>
</body>
</html>
